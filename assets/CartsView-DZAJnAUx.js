import{m as y,a as T}from"./pinia@2.1.7_vue@3.4.19-BGrtT45R.js";import{l as S}from"./alert-Dw2Xe9FX.js";import{c as v}from"./userCart-B29TuF3F.js";import{L,s as N}from"./sleep-cat-BsU9ZqEC.js";import{m as k,l as E}from"./@vue_runtime-dom@3.4.19-Jk3xLe3-.js";import{_ as q}from"./index-TqJ5F-GX.js";import{A as a,Q as t,F as b,ao as V,aJ as f,c as u,aH as h,W as p,P as j,aq as g,z as d,al as I,ak as P}from"./@vue_runtime-core@3.4.19-CKRBtKAL.js";import{P as l,n as Q}from"./@vue_shared@3.4.19-Bk7MlA8B.js";import"./vue-demi@0.14.7_vue@3.4.19-Dq6ymT-8.js";import"./@vue_reactivity@3.4.19-Ddpy7v_1.js";import"./sweetalert2@11.10.5-Csd-Z1-j.js";import"./@ckeditor_ckeditor5-vue@5.1.0-BEtXLgA-.js";import"./vue@3.4.19-C3VIO2t_.js";import"./axios@1.6.7-Di5RpEPX.js";import"./vue3-lottie@3.3.0_vue@3.4.19-BEFDgcS4.js";import"./lottie-web@5.12.2-DrG9waUi.js";/* empty css                               */import"./vee-validate@4.12.5_vue@3.4.19-BmIHdE2I.js";import"./@vee-validate_rules@4.12.5_vue@3.4.19-DqtB_02U.js";import"./@vee-validate_i18n@4.12.5-DXNnfMG0.js";import"./vue-axios@3.5.2_axios@1.6.7_vue@3.4.19-BaogFJPH.js";import"./moment@2.30.1-Cl4UOzQZ.js";import"./vue-loading-overlay@6.0.4_vue@3.4.19-DaNcwJXO.js";import"./vue-router@4.2.5_vue@3.4.19-BBAnl9m5.js";const U={components:{LottiePlayer:L},data(){return{sleepCatJSON:N,couponCode:"",couponUsed:["text-decoration-line-through","text-secondary"],couponEditable:!0,timer:""}},computed:{...y(S,["loadingTask"]),...y(v,["carts","sum"]),couponLabelText(){return this.loadingTask?"套用中":this.carts[0].coupon&&!this.couponEditable?"已套用優惠券":"套用優惠券"}},watch:{carts:{handler(o){o.length&&o[0].coupon&&(this.couponCode=o[0].coupon.code,this.couponEditable=!1)},deep:!0}},methods:{...T(v,["getCarts","updateCart","deleteSingleCart","clearCart","useCoupon"]),checkCoupon(){this.couponEditable?this.couponEditable&&this.couponCode&&this.useCoupon(this.couponCode):this.couponEditable=!0},changeCartQty(o,e){const i=this.carts.find(C=>C.id===o);Number.isInteger(e)?e<=1?i.qty=1:i.qty=e:i.qty=Math.floor(e),this.timer&&clearTimeout(this.timer),e===0?this.deleteSingleCart(i,()=>this.updateCart(i,1)):this.timer=setTimeout(()=>this.updateCart(i,i.qty),500)}},mounted(){var o;this.getCarts(),(o=this.carts[0])!=null&&o.coupon&&(this.couponCode=this.carts[0].coupon.code)}},n=o=>(I("data-v-8d71470d"),o=o(),P(),o),B={class:"d-flex justify-content-end mb-5"},J={class:"d-flex flex-column gap-3"},z={class:"row align-items-center g-3"},A={class:"col-xl-8 col-lg-7"},D={class:"row align-items-stretch gx-3"},F={class:"col-sm-4"},M={class:"cart-img-wrap h-100 overflow-hidden"},O=["src","alt"],R={class:"col-sm-8"},H={class:"cart-info h-100 bg-light px-3 py-5 mb-0 d-flex align-items-center"},W={class:"fs-7 text-muted"},G={class:"mb-0"},K={class:"col-xl-4 col-lg-5"},X={class:"flex-classic gap-3"},Y={class:"input-group"},Z=["disabled","onClick"],$=n(()=>t("i",{class:"bi bi-dash"},null,-1)),tt=[$],ot=["value","onChange"],st=["onClick"],et=n(()=>t("i",{class:"bi bi-plus"},null,-1)),nt=[et],it={class:"w-75 text-end"},lt={class:"mb-0"},at={class:"position-absolute top-0 end-0"},dt=["onClick"],ct=n(()=>t("i",{class:"bi bi-x-lg"},null,-1)),rt=[ct],ut={class:"py-5 border-bottom-dotted"},pt={class:"row justify-content-end gx-1 gy-5"},_t={class:"col-xl-4 col-lg-5"},ht={class:"input-group mb-5"},mt={for:"coupon",class:"input-group-text bg-primary text-white fw-bold"},bt={role:"status",class:"spinner-border spinner-border-sm me-2"},ft=n(()=>t("span",{class:"visually-hidden"},"Loading...",-1)),gt=[ft],Ct=["disabled"],yt=["disabled"],vt={key:0},kt=n(()=>t("b",null,"套用",-1)),wt=[kt],xt={key:1,class:"bi bi-arrow-repeat"},Tt={class:"text-end mb-0"},St=n(()=>t("span",null,"沒有優惠券嗎？",-1)),Lt=n(()=>t("span",null,"來",-1)),Nt=n(()=>t("span",null,[t("b",null,"這裡")],-1)),Et=n(()=>t("span",null,"找找看吧！",-1)),qt={class:"text-end py-5 border-bottom-dotted mb-5"},Vt={key:0,class:"fs-7"},jt={class:"text-danger"},It={class:"fs-5 mb-0"},Pt=n(()=>t("span",null,"總計：",-1)),Qt=n(()=>t("span",null,"NT＄ ",-1)),Ut={class:"flex-classic"},Bt=n(()=>t("span",null,[t("i",{class:"bi bi-caret-left-fill me-1"})],-1)),Jt=n(()=>t("span",null,"繼續購物",-1)),zt=[Bt,Jt],At=["onClick"],Dt=n(()=>t("span",null,"下一步",-1)),Ft=[Dt],Mt={class:"alert bg-light text-center mb-0"};function Ot(o,e,i,C,c,r){const m=g("RouterLink"),w=g("router-link"),x=g("LottiePlayer");return o.carts.length?(d(),a(b,{key:0},[t("div",B,[t("button",{type:"button",class:"btn btn-outline-secondary rounded-1",onClick:e[0]||(e[0]=(...s)=>o.clearCart&&o.clearCart(...s))}," 清空購物車")]),t("div",J,[(d(!0),a(b,null,V(o.carts,s=>(d(),a("div",{key:s,class:"bg-white rounded-1 p-3 position-relative"},[t("div",z,[t("div",A,[t("div",D,[t("div",F,[t("div",M,[u(m,{target:"_blank",to:`/product/${s.product.id}`},{default:h(()=>[t("img",{class:"cart-img object-fit-cover",src:s.product.imageUrl,alt:s.product.title},null,8,O)]),_:2},1032,["to"])])]),t("div",R,[t("div",H,[t("div",null,[t("p",null,[t("b",null,l(s.product.title),1)]),t("p",W,[t("span",null,l(s.product.content),1)]),t("p",G,"單價 NT＄"+l(s.product.price),1)])])])])]),t("div",K,[t("div",X,[t("div",Y,[t("button",{type:"button",class:"input-group-text btn btn-primary",disabled:s.qty<=0,onClick:_=>r.changeCartQty(s.id,s.qty-1)},tt,8,Z),t("input",{type:"number",class:"form-control py-1 text-center",min:"1",value:s.qty,onChange:_=>r.changeCartQty(s.id,+_.target.value)},null,40,ot),t("button",{type:"button",class:"input-group-text btn btn-primary",onClick:_=>r.changeCartQty(s.id,s.qty+1)},nt,8,st)]),t("div",it,[t("p",lt,[t("b",null,"NT＄ "+l(s.total),1)])])])])]),t("div",at,[t("button",{type:"button",class:"btn btn-sm btn-remove btn-primary rounded-1 shadow-sm",onClick:_=>o.deleteSingleCart(s)},rt,8,dt)])]))),128))]),t("div",ut,[t("div",pt,[t("div",_t,[t("div",ht,[t("label",mt,[f(t("div",bt,gt,512),[[k,!!o.loadingTask]]),t("span",null,l(r.couponLabelText),1)]),f(t("input",{id:"coupon",type:"text",class:"form-control","onUpdate:modelValue":e[1]||(e[1]=s=>c.couponCode=s),disabled:o.loadingTask||!c.couponEditable},null,8,Ct),[[E,c.couponCode,void 0,{trim:!0}]]),t("button",{type:"button",class:"btn btn-primary",onClick:e[2]||(e[2]=(...s)=>r.checkCoupon&&r.checkCoupon(...s)),disabled:!!o.loadingTask},[c.couponEditable?(d(),a("span",vt,wt)):(d(),a("i",xt))],8,yt)]),t("p",Tt,[St,Lt,u(w,{target:"_blank",to:{path:"/news",query:{category:"優惠活動"}}},{default:h(()=>[Nt]),_:1}),Et])])])]),t("div",qt,[o.carts[0].coupon?(d(),a("p",Vt,[p(" 折扣了 "),t("span",jt,l(o.sum.total-o.sum.finalTotal),1),p(" 元！ ")])):j("",!0),t("p",It,[Pt,Qt,t("span",{class:Q(o.sum.finalTotal!==o.sum.total?c.couponUsed:"")},l(o.sum.total),3),f(t("span",{class:"ms-1"},l(o.sum.finalTotal),513),[[k,o.sum.finalTotal!==o.sum.total]])])]),t("div",Ut,[t("button",{type:"button",class:"btn btn-outline-primary rounded-1",onClick:e[3]||(e[3]=s=>o.$router.push("/products"))},zt),u(m,{to:"/checkout/form",custom:""},{default:h(({navigate:s})=>[t("button",{type:"button",class:"btn btn-primary rounded-1",onClick:s},Ft,8,At)]),_:1})])],64)):(d(),a(b,{key:1},[t("div",Mt,[p(" 購物車空空如也！ 去"),u(m,{class:"text-info",to:"/products"},{default:h(()=>[p("逛逛")]),_:1}),p("吧！ ")]),u(x,{json:c.sleepCatJSON},null,8,["json"])],64))}const bo=q(U,[["render",Ot],["__scopeId","data-v-8d71470d"]]);export{bo as default};
