import{i as l,j as i}from"./index-BgTYlOVE.js";import{u,a as h}from"./alert-CE4qGltT.js";var d={VITE_APP_SITE:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"ataraxia",BASE_URL:"/2024-Art-Webshop-Project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_SITE:n}=d,t=u(),r=h(),p=l("adminAuth",{state:()=>({isLogin:!1}),actions:{login(e){t.createLoader("login"),i.post(`${n}/admin/signin`,e).then(o=>{const{message:s,token:a,expired:c}=o.data;document.cookie=`hexVueToken=${a}; expires=${new Date(c)}`,r.toastAlert(s,"success"),setTimeout(()=>{this.router.replace("/admin")},1500)}).catch(o=>r.errorAlert(o)).finally(()=>t.removeLoader("login"))},checkLogin(e){var s;t.createLoader("check-login");const o=(s=document.cookie.split("; ").find(a=>a.startsWith("hexVueToken=")))==null?void 0:s.split("=")[1];i.defaults.headers.common.Authorization=o,i.post(`${n}/api/user/check`).then(()=>{this.changeLoginState(!0)}).catch(a=>{e!=="/login"&&(r.errorAlert(a),setTimeout(()=>{this.router.push("/login")},1500))}).finally(()=>t.removeLoader("check-login"))},logout(){t.createLoader("logout"),i.post(`${n}/logout`).then(e=>{document.cookie="hexVueToken=; Max-Age=-1",this.changeLoginState(!1),r.toastAlert(e.data.message,"success"),setTimeout(()=>{this.router.replace("/login")},1500)}).catch(e=>r.errorAlert(e)).finally(()=>t.removeLoader("logout"))},changeLoginState(e){this.isLogin=e}}});export{p as a};
