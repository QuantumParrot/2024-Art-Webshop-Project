import{a as s}from"./axios@1.6.7-Di5RpEPX.js";import{d as l}from"./pinia@2.1.7_vue@3.4.19-BaxWQ2Jo.js";import{l as h,a as u}from"./alert-se1nEnsJ.js";var d={VITE_APP_SITE:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"ataraxia",BASE_URL:"/2024-Art-Webshop-Project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_SITE:n}=d,t=h(),r=u(),f=l("adminAuth",{state:()=>({isLogin:!1}),actions:{login(e){t.createLoader("login"),s.post(`${n}/admin/signin`,e).then(o=>{const{message:i,token:a,expired:c}=o.data;document.cookie=`hexVueToken=${a}; expires=${new Date(c)}`,r.toastAlert(i,"success"),setTimeout(()=>{this.router.replace("/admin")},1500)}).catch(o=>r.errorAlert(o)).finally(()=>t.removeLoader("login"))},checkLogin(e){var i;t.createLoader("check-login");const o=(i=document.cookie.split("; ").find(a=>a.startsWith("hexVueToken=")))==null?void 0:i.split("=")[1];s.defaults.headers.common.Authorization=o,s.post(`${n}/api/user/check`).then(()=>{this.changeLoginState(!0)}).catch(a=>{e!=="/login"&&(r.errorAlert(a),setTimeout(()=>{this.router.push("/login")},1500))}).finally(()=>t.removeLoader("check-login"))},logout(){t.createLoader("logout"),s.post(`${n}/logout`).then(e=>{document.cookie="hexVueToken=; Max-Age=-1",this.changeLoginState(!1),r.toastAlert(e.data.message,"success"),setTimeout(()=>{this.router.replace("/login")},1500)}).catch(e=>r.errorAlert(e)).finally(()=>t.removeLoader("logout"))},changeLoginState(e){this.isLogin=e}}});export{f as a};
