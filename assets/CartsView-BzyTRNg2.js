import{_ as x,a as S}from"./index-Bd2MCN8z.js";import{m as y,l as E}from"./@vue_runtime-dom@3.4.19-Jk3xLe3-.js";import{m as v,a as L}from"./pinia@2.1.7_vue@3.4.19-BGrtT45R.js";import{l as N}from"./alert-DjlOGdg_.js";import{c as k}from"./userCart-Mdye1_nz.js";import{s as P}from"./sleep-cat-CaUVF19w.js";import{A as a,Q as t,F as b,ao as V,aJ as f,c as u,aH as h,W as p,P as q,X as I,aq as g,z as c,al as j,ak as Q}from"./@vue_runtime-core@3.4.19-CKRBtKAL.js";import{P as l,n as A}from"./@vue_shared@3.4.19-Bk7MlA8B.js";/* empty css                               */import"./vee-validate@4.12.5_vue@3.4.19-BmIHdE2I.js";import"./@vue_reactivity@3.4.19-Ddpy7v_1.js";import"./@vee-validate_rules@4.12.5_vue@3.4.19-DqtB_02U.js";import"./@vee-validate_i18n@4.12.5-DXNnfMG0.js";import"./axios@1.6.7-Di5RpEPX.js";import"./vue-axios@3.5.2_axios@1.6.7_vue@3.4.19-BaogFJPH.js";import"./moment@2.30.1-Cl4UOzQZ.js";import"./vue-loading-overlay@6.0.4_vue@3.4.19-DaNcwJXO.js";import"./@ckeditor_ckeditor5-vue@5.1.0-BEtXLgA-.js";import"./vue@3.4.19-C3VIO2t_.js";import"./vue-router@4.2.5_vue@3.4.19-BBAnl9m5.js";import"./vue-demi@0.14.7_vue@3.4.19-Dq6ymT-8.js";import"./sweetalert2@11.10.5-Csd-Z1-j.js";const U=I(()=>S(()=>import("./LottiePlayer-ByRoDad9.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22]))),B={components:{LottiePlayer:U},data(){return{sleepCatJSON:P,couponCode:"",couponUsed:["text-decoration-line-through","text-secondary"],couponEditable:!0,timer:""}},computed:{...v(N,["loadingTask"]),...v(k,["carts","sum"]),couponLabelText(){return this.loadingTask?"套用中":this.carts[0].coupon&&!this.couponEditable?"已套用優惠券":"套用優惠券"}},watch:{carts:{handler(o){o.length&&o[0].coupon&&(this.couponCode=o[0].coupon.code,this.couponEditable=!1)},deep:!0}},methods:{...L(k,["getCarts","updateCart","deleteSingleCart","clearCart","useCoupon"]),checkCoupon(){this.couponEditable?this.couponEditable&&this.couponCode&&this.useCoupon(this.couponCode):this.couponEditable=!0},changeCartQty(o,e){const i=this.carts.find(C=>C.id===o);Number.isInteger(e)?e<=1?i.qty=1:i.qty=e:i.qty=Math.floor(e),this.timer&&clearTimeout(this.timer),e===0?this.deleteSingleCart(i,()=>this.updateCart(i,1)):this.timer=setTimeout(()=>this.updateCart(i,i.qty),500)}},mounted(){var o;this.getCarts(),(o=this.carts[0])!=null&&o.coupon&&(this.couponCode=this.carts[0].coupon.code)}},n=o=>(j("data-v-9369a2f5"),o=o(),Q(),o),D={class:"d-flex justify-content-end mb-5"},J={class:"d-flex flex-column gap-3"},O={class:"row align-items-center g-3"},R={class:"col-xl-8 col-lg-7"},z={class:"row align-items-stretch gx-3"},F={class:"col-sm-4"},M={class:"cart-img-wrap h-100 overflow-hidden"},H=["src","alt"],W={class:"col-sm-8"},X={class:"cart-info h-100 bg-light px-3 py-5 mb-0 d-flex align-items-center"},G={class:"fs-7 text-muted"},K={class:"mb-0"},Y={class:"col-xl-4 col-lg-5"},Z={class:"flex-classic gap-3"},$={class:"input-group"},tt=["disabled","onClick"],ot=n(()=>t("i",{class:"bi bi-dash"},null,-1)),st=[ot],et=["value","onChange"],nt=["onClick"],it=n(()=>t("i",{class:"bi bi-plus"},null,-1)),lt=[it],at={class:"w-75 text-end"},ct={class:"mb-0"},dt={class:"position-absolute top-0 end-0"},rt=["onClick"],ut=n(()=>t("i",{class:"bi bi-x-lg"},null,-1)),pt=[ut],_t={class:"py-5 border-bottom-dotted"},ht={class:"row justify-content-end gx-1 gy-5"},mt={class:"col-xl-4 col-lg-5"},bt={class:"input-group mb-5"},ft={for:"coupon",class:"input-group-text bg-primary text-white fw-bold"},gt={role:"status",class:"spinner-border spinner-border-sm me-2"},Ct=n(()=>t("span",{class:"visually-hidden"},"Loading...",-1)),yt=[Ct],vt=["disabled"],kt=["disabled"],Tt={key:0},wt=n(()=>t("b",null,"套用",-1)),xt=[wt],St={key:1,class:"bi bi-arrow-repeat"},Et={class:"text-end mb-0"},Lt=n(()=>t("span",null,"沒有優惠券嗎？",-1)),Nt=n(()=>t("span",null,"來",-1)),Pt=n(()=>t("span",null,[t("b",null,"這裡")],-1)),Vt=n(()=>t("span",null,"找找看吧！",-1)),qt={class:"text-end py-5 border-bottom-dotted mb-5"},It={key:0,class:"fs-7"},jt={class:"text-danger"},Qt={class:"fs-5 mb-0"},At=n(()=>t("span",null,"總計：",-1)),Ut=n(()=>t("span",null,"NT＄ ",-1)),Bt={class:"flex-classic"},Dt=n(()=>t("span",null,[t("i",{class:"bi bi-caret-left-fill me-1"})],-1)),Jt=n(()=>t("span",null,"繼續購物",-1)),Ot=[Dt,Jt],Rt=["onClick"],zt=n(()=>t("span",null,"下一步",-1)),Ft=[zt],Mt={class:"alert bg-light text-center mb-0"};function Ht(o,e,i,C,d,r){const m=g("RouterLink"),T=g("router-link"),w=g("LottiePlayer");return o.carts.length?(c(),a(b,{key:0},[t("div",D,[t("button",{type:"button",class:"btn btn-outline-secondary rounded-1",onClick:e[0]||(e[0]=(...s)=>o.clearCart&&o.clearCart(...s))}," 清空購物車")]),t("div",J,[(c(!0),a(b,null,V(o.carts,s=>(c(),a("div",{key:s,class:"bg-white rounded-1 p-3 position-relative"},[t("div",O,[t("div",R,[t("div",z,[t("div",F,[t("div",M,[u(m,{target:"_blank",to:`/product/${s.product.id}`},{default:h(()=>[t("img",{class:"cart-img object-fit-cover",src:s.product.imageUrl,alt:s.product.title},null,8,H)]),_:2},1032,["to"])])]),t("div",W,[t("div",X,[t("div",null,[t("p",null,[t("b",null,l(s.product.title),1)]),t("p",G,[t("span",null,l(s.product.content),1)]),t("p",K,"單價 NT＄"+l(s.product.price),1)])])])])]),t("div",Y,[t("div",Z,[t("div",$,[t("button",{type:"button",class:"input-group-text btn btn-primary",disabled:s.qty<=0,onClick:_=>r.changeCartQty(s.id,s.qty-1)},st,8,tt),t("input",{type:"number",class:"form-control py-1 text-center",min:"1",value:s.qty,onChange:_=>r.changeCartQty(s.id,+_.target.value)},null,40,et),t("button",{type:"button",class:"input-group-text btn btn-primary",onClick:_=>r.changeCartQty(s.id,s.qty+1)},lt,8,nt)]),t("div",at,[t("p",ct,[t("b",null,"NT＄ "+l(s.total),1)])])])])]),t("div",dt,[t("button",{type:"button",class:"btn btn-sm btn-remove btn-primary rounded-1 shadow-sm",onClick:_=>o.deleteSingleCart(s)},pt,8,rt)])]))),128))]),t("div",_t,[t("div",ht,[t("div",mt,[t("div",bt,[t("label",ft,[f(t("div",gt,yt,512),[[y,!!o.loadingTask]]),t("span",null,l(r.couponLabelText),1)]),f(t("input",{id:"coupon",type:"text",class:"form-control","onUpdate:modelValue":e[1]||(e[1]=s=>d.couponCode=s),disabled:o.loadingTask||!d.couponEditable},null,8,vt),[[E,d.couponCode,void 0,{trim:!0}]]),t("button",{type:"button",class:"btn btn-primary",onClick:e[2]||(e[2]=(...s)=>r.checkCoupon&&r.checkCoupon(...s)),disabled:!!o.loadingTask},[d.couponEditable?(c(),a("span",Tt,xt)):(c(),a("i",St))],8,kt)]),t("p",Et,[Lt,Nt,u(T,{target:"_blank",to:{path:"/news",query:{category:"優惠活動"}}},{default:h(()=>[Pt]),_:1}),Vt])])])]),t("div",qt,[o.carts[0].coupon?(c(),a("p",It,[p(" 折扣了 "),t("span",jt,l(o.sum.total-o.sum.finalTotal),1),p(" 元！ ")])):q("",!0),t("p",Qt,[At,Ut,t("span",{class:A(o.sum.finalTotal!==o.sum.total?d.couponUsed:"")},l(o.sum.total),3),f(t("span",{class:"ms-1"},l(o.sum.finalTotal),513),[[y,o.sum.finalTotal!==o.sum.total]])])]),t("div",Bt,[t("button",{type:"button",class:"btn btn-outline-primary rounded-1",onClick:e[3]||(e[3]=s=>o.$router.push("/products"))},Ot),u(m,{to:"/checkout/form",custom:""},{default:h(({navigate:s})=>[t("button",{type:"button",class:"btn btn-primary rounded-1",onClick:s},Ft,8,Rt)]),_:1})])],64)):(c(),a(b,{key:1},[t("div",Mt,[p(" 購物車空空如也！ 去"),u(m,{class:"text-info",to:"/products"},{default:h(()=>[p("逛逛")]),_:1}),p("吧！ ")]),u(w,{json:d.sleepCatJSON},null,8,["json"])],64))}const bo=x(B,[["render",Ht],["__scopeId","data-v-9369a2f5"]]);export{bo as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/LottiePlayer-ByRoDad9.js","assets/vue3-lottie@3.3.0_vue@3.4.19-BEFDgcS4.js","assets/lottie-web@5.12.2-DrG9waUi.js","assets/@ckeditor_ckeditor5-vue@5.1.0-BEtXLgA-.js","assets/vue@3.4.19-C3VIO2t_.js","assets/@vue_runtime-dom@3.4.19-Jk3xLe3-.js","assets/@vue_runtime-core@3.4.19-CKRBtKAL.js","assets/@vue_reactivity@3.4.19-Ddpy7v_1.js","assets/@vue_shared@3.4.19-Bk7MlA8B.js","assets/index-Bd2MCN8z.js","assets/pinia@2.1.7_vue@3.4.19-BGrtT45R.js","assets/vue-demi@0.14.7_vue@3.4.19-Dq6ymT-8.js","assets/vee-validate@4.12.5_vue@3.4.19-BmIHdE2I.js","assets/@vee-validate_rules@4.12.5_vue@3.4.19-DqtB_02U.js","assets/@vee-validate_i18n@4.12.5-DXNnfMG0.js","assets/axios@1.6.7-Di5RpEPX.js","assets/vue-axios@3.5.2_axios@1.6.7_vue@3.4.19-BaogFJPH.js","assets/moment@2.30.1-Cl4UOzQZ.js","assets/vue-loading-overlay@6.0.4_vue@3.4.19-DaNcwJXO.js","assets/vue-loading-overlay@6.0.4_vue@3.4-nP5dPYjw.css","assets/vue-router@4.2.5_vue@3.4.19-BBAnl9m5.js","assets/index-DsAfvrbl.css","assets/bootstrap-icons@1.11-c-mAhRVX.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
