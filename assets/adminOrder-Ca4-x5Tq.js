import{a as o}from"./axios@1.6.7-Di5RpEPX.js";import{d as n}from"./pinia@2.1.7_vue@3.4.19-CHKlOEZr.js";import{l as h,a as m}from"./alert-rz954VAU.js";var p={VITE_APP_SITE:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"ataraxia",BASE_URL:"/2024-Art-Webshop-Project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_SITE:d,VITE_APP_PATH:i}=p,r=h(),a=m(),P=n("adminOrder",{state:()=>({orders:[],statesCode:{0:{title:"未確認款項",color:"#c62828"},1:{title:"已確認款項",color:"#ff6f00"},2:{title:"安排出貨中",color:"#1565c0"},3:{title:"商品配送中",color:"#00838f"},4:{title:"訂單已完成",color:"#388e3c"}},currentPage:1,orderState:"",isPaid:""}),getters:{totalPages:({orders:e})=>Math.ceil(e.length/5),ordersList:({orders:e})=>e.map(t=>{if(t.message.startsWith('{"')){const s=JSON.parse(t.message);return{...t,message:s.message||"無",project:s.project,state:parseInt(s.state,10),total:parseInt(t.total.toFixed(0),10)}}return{...t,project:t.project||"不指定",state:t.state||0,total:parseInt(t.total.toFixed(0),10)}}),unhandled:({ordersList:e})=>e.filter(t=>t.is_paid&&t.state===0).length},actions:{switchPage(e){this.currentPage=e},getOrders(){r.createLoader("get-orders"),o.get(`${d}/api/${i}/admin/orders`).then(e=>{this.orders=e.data.orders,this.switchPage(1)}).catch(e=>a.errorAlert(e)).finally(()=>r.removeLoader("get-orders"))},updateOrder(e,t){const{code:s,order:l}=e;r.setLoader(l.id),o.put(`${d}/api/${i}/admin/order/${l.id}`,{data:{...l,state:Number(s)}}).then(c=>{a.toastAlert(c.data.message,"success"),t(),this.getOrders()}).catch(c=>a.errorAlert(c)).finally(()=>r.setLoader(""))},deleteOrder(e,t){r.createLoader("delete-order"),o.delete(`${d}/api/${i}/admin/order/${e}`).then(()=>{a.toastAlert("我們懷念它 (´;ω;`)","success"),t(),this.getOrders()}).catch(s=>a.errorAlert(s)).finally(()=>r.removeLoader("delete-order"))},downTheDrain(){a.multiverseAlert(()=>{r.createLoader("tan-tiau"),o.delete(`${d}/api/${i}/admin/orders/all`).then(()=>{a.toastAlert("沒了 ... 都沒了 (´;ω;`)","success"),this.getOrders()}).catch(e=>a.errorAlert(e)).finally(()=>r.removeLoader("tan-tiau"))})}}});export{P as a};
