import{a as l}from"./axios@1.6.7-Di5RpEPX.js";import{d as h}from"./pinia@2.1.7_vue@3.4.19-CHKlOEZr.js";import{l as P}from"./loader-CArRiQTv.js";import{a as m}from"./alert-C5k3uZHZ.js";var f={VITE_APP_SITE:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"ataraxia",BASE_URL:"/2024-Art-Webshop-Project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const d=P(),n=m(),{VITE_APP_SITE:p,VITE_APP_PATH:g}=f,E=h("userProduct",{state:()=>({products:[],pagination:{},product:{},relatedProducts:[]}),actions:{getProducts(o="",t=1){d.createLoader("get-user-products"),l.get(`${p}/api/${g}/products?category=${o}&page=${t}`).then(r=>{this.products=r.data.products,this.pagination=r.data.pagination}).catch(r=>n.errorAlert(r)).finally(()=>d.removeLoader("get-user-products"))},getProduct(o){d.createLoader("get-single-product"),l.get(`${p}/api/${g}/product/${o}`).then(t=>{this.product=t.data.product,this.getRelatedProducts(t.data.product)}).catch(t=>n.errorAlert(t)).finally(()=>d.removeLoader("get-single-product"))},getRelatedProducts(o){d.createLoader("get-related-products"),l.get(`${p}/api/${g}/products/all`).then(t=>{const{category:r,tags:c}=o;let{products:a}=t.data;a=a.filter(s=>s.id!==o.id&&Array.isArray(s.tags));const e=a.filter(s=>s.tags.some(u=>c.includes(u)));if(e.length<3){const s=e.map(i=>i.id),u=a.filter(i=>i.category===r&&!s.includes(i.id));e.push(...this.getRandomProducts(u,3-e.length)),this.relatedProducts=e.length<3?this.getRandomProducts(a,3-e.length):e}else this.relatedProducts=this.getRandomProducts(e,3)}).catch(t=>n.errorAlert(t)).finally(()=>d.removeLoader("get-related-products"))},getRandomProducts(o,t){let r=0;const c=[...o],a=[];function e(){const s=Math.floor(Math.random()*c.length);r+=1,a.push(...c.splice(s,1))}for(;r<t;)e();return a}}});export{E as u};
