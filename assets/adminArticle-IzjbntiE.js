import{a as s}from"./axios@1.6.7-Di5RpEPX.js";import{d as A}from"./pinia@2.1.7_vue@3.4.19-CHKlOEZr.js";import{l as h,a as p}from"./alert-dm0RMdUk.js";var u={VITE_APP_SITE:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"ataraxia",BASE_URL:"/2024-Art-Webshop-Project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_SITE:o,VITE_APP_PATH:l}=u,a=h(),i=p(),f=A("adminArticle",{state:()=>({articles:[],categories:{網站公告:["網站測試","優惠活動","價格調整","營運通知","展覽資訊","講座資訊"],專欄文章:["藝術","歷史","地球","天文"]},pagination:{}}),getters:{tags:({articles:e})=>{const t=[];return e.forEach(r=>r.tag.forEach((c,n)=>{n!==0&&!t.includes(c)&&t.push(c)})),t}},actions:{getArticles(e=1){a.createLoader("get-articles"),s.get(`${o}/api/${l}/admin/articles?page=${e}`).then(t=>{const{articles:r,pagination:c}=t.data;this.articles=r.sort((n,d)=>d.create_at-n.create_at),this.pagination=c}).catch(t=>i.errorAlert(t)).finally(()=>a.removeLoader("get-articles"))},createArticle(e,t){a.createLoader("create-article"),s.post(`${o}/api/${l}/admin/article`,{data:e}).then(r=>{i.toastAlert(r.data.message,"success"),t(),this.getArticles()}).catch(r=>i.errorAlert(r)).finally(()=>a.removeLoader("create-article"))},updateArticle(e,t){a.createLoader("update-article"),s.put(`${o}/api/${l}/admin/article/${e.id}`,{data:e}).then(r=>{i.toastAlert(r.data.message,"success"),t(),this.getArticles()}).catch(r=>i.errorAlert(r)).finally(()=>a.removeLoader("update-article"))},deleteArticle(e,t){const r={title:"確定刪除文章？",text:`名稱：${t}`};i.checkAlert(r,()=>{a.createLoader("delete-article"),s.delete(`${o}/api/${l}/admin/article/${e}`).then(c=>{i.toastAlert(c.data.message,"success"),this.getArticles()}).catch(c=>i.errorAlert(c)).finally(()=>a.removeLoader("delete-article"))})},switchArticleStatus(e){const t=e.isPublic;a.createLoader("switch-article-status"),s.put(`${o}/api/${l}/admin/article/${e.id}`,{data:{...e,content:e.description,isPublic:!e.isPublic}}).then(()=>{i.toastAlert(`文章已${t?"隱藏":"公開"}`,"success"),this.getArticles()}).catch(r=>i.errorAlert(r)).finally(()=>a.removeLoader("switch-article-status"))}}});export{f as a};
