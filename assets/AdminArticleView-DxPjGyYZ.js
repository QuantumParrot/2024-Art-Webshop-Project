import{m as I,a as A}from"./pinia@2.1.7_vue@3.4.19-BGrtT45R.js";import{a as w}from"./adminArticle-BmFaxZSC.js";import{l as D,a as T}from"./alert-BXjizhtP.js";import{b as L}from"./@ckeditor_ckeditor5-vue@5.1.0-nKXmQdRT.js";import{m as H}from"./modal-BexZxidR.js";import{C as N}from"./@ckeditor_ckeditor5-editor-classic@41.1.0-CjjLLtJ9.js";import{E as B}from"./@ckeditor_ckeditor5-essentials@41.1.0-DYVtM_c8.js";import{B as O,I as j}from"./@ckeditor_ckeditor5-basic-styles@41.1.0-8qTJ0ExI.js";import"./@ckeditor_ckeditor5-utils@41.1.0-Cn-yVoWx.js";import"./@ckeditor_ckeditor5-core@41.1.0-D0yh88O_.js";import"./@ckeditor_ckeditor5-engine@41.1.0-CtehaBhy.js";import"./@ckeditor_ckeditor5-ui@41.1.0-CruSshla.js";import"./color-convert@2.0.1-DwB1f1Hp.js";import{L as z}from"./@ckeditor_ckeditor5-link@41.1.0-BgEtoalO.js";import"./@ckeditor_ckeditor5-widget@41.1.0-C7COOHdf.js";import"./@ckeditor_ckeditor5-clipboard@41.1.0-DsoO1w0S.js";import{H as R}from"./@ckeditor_ckeditor5-heading@41.1.0-D_89Fa26.js";import"./@ckeditor_ckeditor5-paragraph@41.1.0-CHtOsC2T.js";import{F as J}from"./@ckeditor_ckeditor5-font@41.1.0-CVF1qZLU.js";import{U as Q}from"./UploadForm-CC4PpzIB.js";import{m as k,v as U,l as W,n as P}from"./@vue_runtime-dom@3.4.19-DAqtRikk.js";import{_ as q}from"./index-CiwxSB-b.js";import{z as r,A as a,Q as t,c as n,aH as G,aJ as u,P as g,F as v,ao as S,aq as h,al as K,ak as X}from"./@vue_runtime-core@3.4.19-CKRBtKAL.js";import{P as c,n as _}from"./@vue_shared@3.4.19-Bk7MlA8B.js";import{P as Y}from"./PaginationComponent-Dn3_800B.js";import"./vue-demi@0.14.7_vue@3.4.19-Dq6ymT-8.js";import"./@vue_reactivity@3.4.19-Ddpy7v_1.js";import"./axios@1.6.7-Di5RpEPX.js";import"./sweetalert2@11.10.5-BAvl06kU.js";import"./vue@3.4.19-DAUBsDVh.js";import"./bootstrap@5.3.2_@popperjs_core@2.11.8-Bc1vvLaR.js";import"./@ckeditor_ckeditor5-watchdog@41.1.0-B5W-sfM8.js";import"./lodash-es@4.17.21-C5qYGfgy.js";import"./@ckeditor_ckeditor5-typing@41.1.0-DSIargVI.js";import"./@ckeditor_ckeditor5-enter@41.1.0-CzFUQWGc.js";import"./@ckeditor_ckeditor5-select-all@41.1.0-C1rm83vP.js";import"./@ckeditor_ckeditor5-undo@41.1.0-fHAidiMb.js";import"./color-parse@1.4.2-BJJ_QcBL.js";import"./color-name@1.1.4-COG9r6Ya.js";import"./vanilla-colorful@0.7.2-PEGE98j7.js";import"./ClipboardComponent-aMC5_iL0.js";import"./clipboard@2.0.11-DRrgEAvM.js";/* empty css                               *//* empty css                          */import"./vee-validate@4.12.5_vue@3.4.19-BmIHdE2I.js";import"./@vee-validate_rules@4.12.5_vue@3.4.19-DqtB_02U.js";import"./@vee-validate_i18n@4.12.5-DXNnfMG0.js";import"./vue-axios@3.5.2_axios@1.6.7_vue@3.4.19-BaogFJPH.js";import"./vue3-lottie@3.3.0_vue@3.4.19-BfItuFlz.js";import"./lottie-web@5.12.2-CU4Beet5.js";import"./moment@2.30.1-Cl4UOzQZ.js";import"./vue-loading-overlay@6.0.4_vue@3.4.19-Cjw3eg2V.js";import"./vue-router@4.2.5_vue@3.4.19-BBAnl9m5.js";import"./aos@2.3.4-Cu9ud2ZH.js";const b=["mb-3"],Z={options:[{model:"paragraph",view:{name:"p",classes:["fs-6",...b]},title:"paragraph"},{model:"heading1",view:{name:"h2",classes:["fs-2",...b]},title:"bootstrap - H2"},{model:"heading2",view:{name:"h3",classes:["fs-3",...b]},title:"bootstrap - H3"},{model:"heading3",view:{name:"h4",classes:["fs-4",...b]},title:"bootstrap - H4"},{model:"heading4",view:{name:"h5",classes:["fs-5",...b]},title:"bootstrap - H5"},{model:"text",view:{name:"p",classes:["fs-7",...b]},title:"small text"}]},$={data(){return{editor:N,editorConfig:{plugins:[B,O,j,z,R,J],toolbar:{items:["undo","redo","|","heading","bold","italic","fontSize","fontFamily","fontColor","|","link"]},link:{decorators:{openInNewTab:{mode:"manual",defaultValue:!0,attributes:{target:"_blank",rel:"noopener noreferrer"},label:"是否另開新視窗"}}},heading:Z}}}},tt={mixins:[H,$],components:{ckeditor:L.component,UploadForm:Q},props:["type","tempArticle"],data(){return{tab:"setting",article:{},uploadState:!1}},computed:{...I(w,["categories"]),createAt:{get(){return this.$calc.formatDate(this.article.create_at*1e3)},set(i){this.article.create_at=new Date(i).getTime()/1e3}}},methods:{...A(w,["createArticle","updateArticle"]),updateData(){this.article=this.tempArticle,this.article.tag=Array.isArray(this.tempArticle.tag)?this.tempArticle.tag:[],this.type==="網站公告"&&(this.article.author="收藏家工作室")},confirmUpdate(){this.type==="公益計劃"&&(this.article.content="無"),this.type==="網站公告"&&(this.article.description="無"),this.article.tag=this.article.tag.filter(i=>i),this.article.type=this.type,this.article.id?this.updateArticle(this.article,this.hideModal):this.createArticle(this.article,this.hideModal)},addNewImage(i){this.article.image=i},updateUploadState(i){this.uploadState=i}},watch:{tempArticle(){this.updateData()}},mounted(){this.updateData()}},et={class:"modal modal-lg fade",tabindex:"-1",ref:"modal"},ot={class:"modal-dialog modal-dialog-centered"},it={class:"modal-content"},lt={class:"modal-header flex-classic"},st={class:"mb-0"},rt=t("i",{class:"bi bi-x-circle-fill"},null,-1),at=[rt],nt={class:"modal-body"},ct={class:"nav nav-pills bg-gray rounded-2 mb-3"},dt={class:"nav-item flex-grow-1"},mt={class:"nav-item flex-grow-1"},pt={class:"nav-item flex-grow-1"},ut={class:"mb-5"},ht={class:"form-label is-required",for:"title"},_t={class:"mb-5"},ft={class:"row row-cols-2"},bt={class:"col"},gt={class:"form-label is-required",for:"author"},vt={class:"col"},yt=t("label",{class:"form-label is-required",for:"create_at"},[t("span",null,"發表日期")],-1),kt={key:0,class:"mb-5"},At=t("label",{for:"link",class:"form-label is-required"},"網站連結",-1),wt={key:1,class:"mb-5"},Vt=t("label",{for:"description",class:"form-label is-required"},"摘要",-1),Ct={key:2,class:"form-check"},xt=t("label",{for:"recommend",class:"form-label"},"是否需要推薦商品",-1),Pt=t("p",{class:"fs-7 text-muted"},"建議：新聞專欄不需要推薦商品喔！",-1),St=t("label",{for:"category",class:"form-label is-required"},[t("span",null,"分類")],-1),Mt={id:"categories"},Ut=["value"],It={class:"mb-5"},qt=t("p",null,"標籤",-1),Et=t("p",{class:"fs-7 text-muted"},"選擇和商品一致的標籤，就能向客戶推薦相關商品喔！",-1),Ft={class:"row gy-3 mb-3"},Dt=["onUpdate:modelValue"],Tt=["onClick"],Lt=t("i",{class:"bi bi-x-lg"},null,-1),Ht=[Lt],Nt={class:"mb-5"},Bt=t("label",{class:"form-label is-required",for:"image"},"圖片",-1),Ot=["href"],jt=["src","alt"],zt=t("hr",null,null,-1),Rt=t("hr",null,null,-1),Jt=t("p",{class:"is-required"},"詳細內容",-1),Qt={class:"modal-footer justify-content-between align-items-center"},Wt={class:"form-check"},Gt=t("label",{class:"form-label mb-0",for:"isPublic"},"是否公開",-1),Kt=["disabled"];function Xt(i,o,d,E,e,m){const V=h("LoadingOverlay"),p=h("VField"),s=h("UploadForm"),y=h("ckeditor"),F=h("VForm");return r(),a("div",et,[t("div",ot,[n(V,{"is-loading":e.uploadState,"is-full":!1},null,8,["is-loading"]),t("div",it,[t("div",lt,[t("h4",st,c(d.type),1),t("button",{type:"button",class:"btn border-0 p-0 fs-4",onClick:o[0]||(o[0]=(...C)=>i.hideModal&&i.hideModal(...C))},at)]),n(F,{onSubmit:m.confirmUpdate,ref:"form"},{default:G(({meta:C})=>[t("div",nt,[t("ul",ct,[t("li",dt,[t("button",{type:"button",onClick:o[1]||(o[1]=l=>e.tab="setting"),class:_(["w-100 nav-link",{active:e.tab==="setting"}])}," 設定",2)]),t("li",mt,[t("button",{type:"button",onClick:o[2]||(o[2]=l=>e.tab="category"),class:_(["w-100 nav-link",{active:e.tab==="category"}])}," 分類",2)]),t("li",pt,[t("button",{type:"button",onClick:o[3]||(o[3]=l=>e.tab="image"),class:_(["w-100 nav-link",{active:e.tab==="image"}])}," 圖片",2)])]),u(t("div",null,[t("div",ut,[t("label",ht,[t("span",null,c(d.type==="公益計劃"?"組織名稱":"標題"),1)]),n(p,{id:"title",type:"text",class:"form-control",modelValue:e.article.title,"onUpdate:modelValue":o[4]||(o[4]=l=>e.article.title=l),modelModifiers:{trim:!0},name:"title",rules:"required"},null,8,["modelValue"])]),t("div",_t,[t("div",ft,[t("div",bt,[t("label",gt,[t("span",null,c(d.type==="公益計劃"?"完整法人名稱":"作者"),1)]),n(p,{id:"author",type:"text",class:"form-control",modelValue:e.article.author,"onUpdate:modelValue":o[5]||(o[5]=l=>e.article.author=l),modelModifiers:{trim:!0},name:"author",rules:"required"},null,8,["modelValue"])]),t("div",vt,[yt,n(p,{id:"create_at",type:"date",class:"form-control",modelValue:m.createAt,"onUpdate:modelValue":o[6]||(o[6]=l=>m.createAt=l),name:"create_at",rules:"required"},null,8,["modelValue"])])])]),d.type==="公益計劃"?(r(),a("div",kt,[At,n(p,{id:"link",type:"text",class:"form-control",modelValue:e.article.link,"onUpdate:modelValue":o[7]||(o[7]=l=>e.article.link=l),modelModifiers:{trim:!0},name:"link",rules:"required|url",placeholder:"請提供該組織的官方連結，讓使用者可以透過連結拜訪"},null,8,["modelValue"])])):g("",!0),d.type!=="網站公告"?(r(),a("div",wt,[Vt,n(p,{id:"title",rows:"3",class:"form-control",modelValue:e.article.description,"onUpdate:modelValue":o[8]||(o[8]=l=>e.article.description=l),modelModifiers:{trim:!0},name:"description",as:"textarea"},null,8,["modelValue"])])):g("",!0),d.type==="專欄文章"?(r(),a("div",Ct,[u(t("input",{type:"checkbox",id:"recommend",class:"form-check-input","onUpdate:modelValue":o[9]||(o[9]=l=>e.article.recommend=l)},null,512),[[U,e.article.recommend]]),xt,Pt])):g("",!0)],512),[[k,e.tab==="setting"]]),u(t("div",null,[t("div",{class:_({"mb-5":d.type!=="公益計劃"})},[St,n(p,{id:"category",class:"form-control",list:"categories",modelValue:e.article.category,"onUpdate:modelValue":o[10]||(o[10]=l=>e.article.category=l),modelModifiers:{trim:!0},name:"category",rules:"required"},null,8,["modelValue"]),t("datalist",Mt,[(r(!0),a(v,null,S(i.categories[d.type],l=>(r(),a("option",{key:l,value:l},c(l),9,Ut))),128))])],2),u(t("div",It,[qt,Et,t("div",Ft,[(r(!0),a(v,null,S(e.article.tag,(l,x)=>(r(),a("div",{class:"col-md-3 position-relative",key:l},[u(t("input",{type:"text",class:"form-control","onUpdate:modelValue":M=>e.article.tag[x]=M},null,8,Dt),[[W,e.article.tag[x]]]),t("button",{type:"button",class:"btn btn-origin btn-inline",onClick:M=>e.article.tag.splice(x,1)},Ht,8,Tt)]))),128))]),t("button",{type:"button",class:"btn btn-primary",onClick:o[11]||(o[11]=l=>e.article.tag.push(""))}," 新增標籤")],512),[[k,d.type==="專欄文章"]])],512),[[k,e.tab==="category"]]),u(t("div",null,[t("div",Nt,[Bt,n(p,{id:"image",type:"text",class:"form-control",modelValue:e.article.image,"onUpdate:modelValue":o[12]||(o[12]=l=>e.article.image=l),modelModifiers:{trim:!0},name:"image",rules:"required|url"},null,8,["modelValue"]),e.article.image?(r(),a("a",{key:0,target:"_blank",href:e.article.image},[t("img",{class:"object-fit-cover mt-3","max-height":"250",src:e.article.image,alt:e.article.title},null,8,jt)],8,Ot)):g("",!0)]),zt,n(s,{"use-clipboard":!1,"upload-state":e.uploadState,disabled:e.article.image,onAddNewImage:m.addNewImage,onUpdateUploadState:m.updateUploadState},null,8,["upload-state","disabled","onAddNewImage","onUpdateUploadState"])],512),[[k,e.tab==="image"]]),d.type!=="公益計劃"?(r(),a(v,{key:0},[Rt,Jt,n(y,{editor:i.editor,config:i.editorConfig,modelValue:e.article.content,"onUpdate:modelValue":o[13]||(o[13]=l=>e.article.content=l)},null,8,["editor","config","modelValue"])],64)):g("",!0)]),t("div",Qt,[t("div",Wt,[u(t("input",{id:"isPublic",type:"checkbox",class:"form-check-input","onUpdate:modelValue":o[14]||(o[14]=l=>e.article.isPublic=l)},null,512),[[U,e.article.isPublic]]),Gt]),t("div",null,[t("button",{type:"submit",class:"btn btn-primary me-2",disabled:!C.valid},"確認更新 ",8,Kt),t("button",{type:"button",class:"btn btn-outline-secondary",onClick:o[15]||(o[15]=(...l)=>i.hideModal&&i.hideModal(...l))},"取消 ")])])]),_:1},8,["onSubmit"])])])],512)}const Yt=q(tt,[["render",Xt]]);var Zt={VITE_APP_SITE:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"ataraxia",BASE_URL:"/2024-Art-Webshop-Project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_SITE:$t,VITE_APP_PATH:te}=Zt,ee={components:{AdminArticleModal:Yt,PaginationComponent:Y},data(){return{filter:"網站公告",currentPage:1,tempArticle:{}}},computed:{...I(w,["articles","article"]),displayingArticles(){return this.articles.filter(i=>i.type===this.filter)},totalPages(){return Math.ceil(this.displayingArticles.length/5)}},methods:{...A(w,["getArticles","getArticle","deleteArticle","switchArticleStatus"]),...A(D,["createLoader","removeLoader"]),...A(T,["errorAlert"]),openModal(i){i?this.getArticle(i):this.tempArticle={isPublic:!1,create_at:this.$calc.now()},this.$refs.articleModal.showModal()},getArticle(i){this.createLoader("get-single-article"),this.$http.get(`${$t}/api/${te}/admin/article/${i}`).then(o=>{this.tempArticle=o.data.article}).catch(o=>this.errorAlert(o)).finally(()=>this.removeLoader("get-single-article"))}},created(){this.articles.length||this.getArticles()}},f=i=>(K("data-v-fc7cd384"),i=i(),X(),i),oe={class:"lh-lg nav nav-tabs nav-fill mb-3 border-bottom"},ie={class:"nav-item"},le=f(()=>t("b",null,"網站公告",-1)),se=[le],re={class:"nav-item"},ae=f(()=>t("b",null,"專欄文章",-1)),ne=[ae],ce={class:"nav-item"},de=f(()=>t("b",null,"公益計劃",-1)),me=[de],pe={class:"text-end mb-3"},ue={class:"text-muted"},he={class:"alert bg-gray flex-classic mb-6"},_e={key:0,class:"table-responsive"},fe={class:"table table-hover text-nowrap"},be=f(()=>t("th",{scope:"col",width:"10%"},"日期",-1)),ge=f(()=>t("th",{scope:"col",width:"10%"},"分類",-1)),ve={scope:"col",width:"50%"},ye=f(()=>t("th",{scope:"col",width:"15%",class:"text-center"},"狀態",-1)),ke=f(()=>t("th",{scope:"col",width:"15%",class:"text-center"},"處理",-1)),Ae={class:"align-middle"},we={class:"badge bg-highlight text-dark py-2"},Ve={class:"fw-bold mb-2"},Ce={class:"text-muted fs-7"},xe={class:"text-center"},Pe={class:"form-switch"},Se=["checked","onChange"],Me={class:"text-center"},Ue={class:"d-flex flex-column gap-2"},Ie=["onClick"],qe=["onClick"],Ee={key:1,class:"alert bg-gray"};function Fe(i,o,d,E,e,m){const V=h("PaginationComponent"),p=h("AdminArticleModal");return r(),a(v,null,[t("ul",oe,[t("li",ie,[t("a",{href:"#",class:_(["nav-link py-3",{active:e.filter==="網站公告"}]),onClick:o[0]||(o[0]=P(s=>e.filter="網站公告",["prevent"]))},se,2)]),t("li",re,[t("a",{href:"#",class:_(["nav-link py-3",{active:e.filter==="專欄文章"}]),onClick:o[1]||(o[1]=P(s=>e.filter="專欄文章",["prevent"]))},ne,2)]),t("li",ce,[t("a",{href:"#",class:_(["nav-link py-3",{active:e.filter==="公益計劃"}]),onClick:o[2]||(o[2]=P(s=>e.filter="公益計劃",["prevent"]))},me,2)])]),t("div",pe,[t("p",ue,"目前共有 "+c(m.displayingArticles.length)+" 篇"+c(e.filter),1)]),t("div",he,[t("div",null,[t("button",{type:"button",class:"btn btn-highlight",onClick:o[3]||(o[3]=s=>m.openModal())}," 新增"+c(e.filter),1)]),n(V,{current:e.currentPage,total:m.totalPages,onSwitchPage:i.getArticles},null,8,["current","total","onSwitchPage"])]),i.articles.length?(r(),a("div",_e,[t("table",fe,[t("thead",null,[t("tr",null,[be,ge,t("th",ve,c(e.filter),1),ye,ke])]),t("tbody",Ae,[(r(!0),a(v,null,S(m.displayingArticles,s=>(r(),a("tr",{key:s.id},[t("td",null,c(i.$calc.formatDate(s.create_at*1e3,"/")),1),t("td",null,[t("span",we,c(s.category),1)]),t("td",null,[t("p",Ve,c(s.title),1),t("span",Ce,"作者｜"+c(s.author),1)]),t("td",xe,[t("div",Pe,[t("input",{type:"checkbox",role:"switch",class:"form-check-input",checked:s.isPublic,onChange:y=>i.switchArticleStatus(s)},null,40,Se)])]),t("td",Me,[t("div",Ue,[t("button",{type:"button",class:"w-100 btn btn-outline-secondary",onClick:y=>m.openModal(s.id)}," 編輯",8,Ie),t("button",{type:"button",class:"w-100 btn btn-outline-danger",onClick:y=>i.deleteArticle(s.id,s.title)}," 刪除",8,qe)])])]))),128))])])])):(r(),a("div",Ee,"還沒有任何文章！趕快新增一篇吧！")),n(p,{ref:"articleModal",type:e.filter,"temp-article":e.tempArticle},null,8,["type","temp-article"])],64)}const To=q(ee,[["render",Fe],["__scopeId","data-v-fc7cd384"]]);export{To as default};
