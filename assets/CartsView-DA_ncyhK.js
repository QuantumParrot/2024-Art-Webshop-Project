import{m as f,a as q}from"./pinia@2.1.7_vue@3.4.19-CHKlOEZr.js";import{l as E}from"./alert-rz954VAU.js";import{c as y}from"./userCart-Cjbn3B9E.js";import{_ as T}from"./index-DjhTBvR6.js";import{aj as l,O as c,P as t,F as _,V as u,N as m,ao as N,aJ as b,M as V,c as k,aH as C,aq as w,al as j,ak as I}from"./@vue_runtime-core@3.4.19-CGfIweqO.js";import{m as x,l as Q}from"./@vue_runtime-dom@3.4.19-AC5g8dxk.js";import{n as h,P as a}from"./@vue_shared@3.4.19-Bk7MlA8B.js";import"./vue-demi@0.14.7_vue@3.4.19-Dq6ymT-8.js";import"./@vue_reactivity@3.4.19-Ddpy7v_1.js";import"./sweetalert2@11.10.5-BCnrvazC.js";import"./@ckeditor_ckeditor5-vue@5.1.0-CegNn2NB.js";import"./vue@3.4.19-CdjQKHui.js";import"./axios@1.6.7-Di5RpEPX.js";/* empty css                               */import"./vee-validate@4.12.5_vue@3.4.19-Bp4gs7Rm.js";import"./@vee-validate_rules@4.12.5_vue@3.4.19-Bg5iSJV4.js";import"./@vee-validate_i18n@4.12.5-DXNnfMG0.js";import"./vue-axios@3.5.2_axios@1.6.7_vue@3.4.19-BaogFJPH.js";import"./moment@2.30.1-Cl4UOzQZ.js";import"./vue-loading-overlay@6.0.4_vue@3.4.19-DG0Fkrwv.js";import"./vue-router@4.2.5_vue@3.4.19-DxgIm9Z7.js";const L={},B={class:"alert bg-white mb-0"};function U(s,e){return l(),c("div",B," 施工中！ ")}const z=T(L,[["render",U]]),F={components:{OrderForm:z},data(){return{step:1,couponCode:"",couponUsed:["text-decoration-line-through","text-secondary"],couponEditable:!0,timer:""}},computed:{...f(E,["isLoading","loadingTask"]),...f(y,["carts","sum"]),couponLabelText(){return this.loadingTask?"套用中":this.carts[0].coupon&&!this.couponEditable?"已套用優惠券":"套用優惠券"}},watch:{carts:{handler(s){s.length&&s[0].coupon&&(this.couponCode=s[0].coupon.code,this.couponEditable=!1)},deep:!0},step(){window.scrollTo(0,0)}},methods:{...q(y,["updateCart","deleteSingleCart","clearCart","useCoupon"]),checkCoupon(){this.couponEditable?this.couponEditable&&this.couponCode&&this.useCoupon(this.couponCode):this.couponEditable=!0},changeCartQty(s,e){const d=this.carts.find(g=>g.id===s);Number.isInteger(e)?e<1?d.qty=1:d.qty=e:d.qty=Math.floor(e),this.timer&&clearTimeout(this.timer),this.timer=setTimeout(()=>this.updateCart(d,d.qty),500)}},mounted(){var s;(s=this.carts[0])!=null&&s.coupon&&(this.couponCode=this.carts[0].coupon.code)}},i=s=>(j("data-v-0bd6a49d"),s=s(),I(),s),M={class:"h-100 bg-gray text-primary"},D={class:"container py-7"},O={class:"row justify-content-center"},P={class:"col-md-10"},A={class:"nav w-100 mb-7 align-items-center justify-content-lg-center justify-content-between gap-lg-4 gap-2"},H=i(()=>t("i",{class:"bi bi-1-square-fill",style:{"line-height":"1"}},null,-1)),J=i(()=>t("span",{class:"h6 mb-0"},"確認購物車",-1)),G=[H,J],K=i(()=>t("div",{class:"d-md-block d-none"},[t("span",{class:"arrow-animation"},[t("span",{class:"arrow"},"➡️")])],-1)),R=i(()=>t("i",{class:"bi bi-2-square-fill",style:{"line-height":"1"}},null,-1)),W=i(()=>t("span",{class:"h6 mb-0"},"填寫收件資訊",-1)),X=[R,W],Y=i(()=>t("div",{class:"d-md-block d-none"},[t("span",{class:"arrow-animation"},[t("span",{class:"arrow"},"➡️")])],-1)),Z=i(()=>t("i",{class:"bi bi-3-square-fill",style:{"line-height":"1"}},null,-1)),$=i(()=>t("span",{class:"h6 mb-0"},"完成付款",-1)),tt=[Z,$],st={class:"flex-classic mb-5"},ot=i(()=>t("i",{class:"bi bi-caret-left-fill"},null,-1)),et={class:"d-flex flex-column gap-3"},it={class:"row align-items-center g-3"},nt={class:"col-xl-8 col-lg-7"},lt={class:"row align-items-stretch gx-3"},ct={class:"col-sm-4"},at={class:"mask z-0"},dt=["src","alt"],rt=i(()=>t("div",{class:"z-2 mask-txt text-light fs-3"},[t("i",{class:"bi bi-box-arrow-up-right"})],-1)),pt={class:"flex-grow-1 col-sm-8"},ut={class:"h-100 bg-light rounded-0 px-3 py-5 mb-0 d-flex align-items-center"},_t={class:"fs-7 text-muted"},ht={class:"mb-0"},mt={class:"col-xl-4 col-lg-5"},bt={class:"flex-classic gap-3"},gt={class:"input-group"},vt=["disabled","onClick"],ft=i(()=>t("i",{class:"bi bi-dash"},null,-1)),yt=[ft],kt=["value","onChange"],Ct=["onClick"],wt=i(()=>t("i",{class:"bi bi-plus"},null,-1)),xt=[wt],Tt={class:"w-75 text-end"},St={class:"mb-0"},qt={class:"position-absolute top-0 end-0"},Et=["onClick"],Nt=i(()=>t("i",{class:"bi bi-x-lg"},null,-1)),Vt=[Nt],jt={class:"py-5 border-bottom-dotted"},It={class:"row justify-content-end gx-1"},Qt={class:"col-xl-4 col-lg-5"},Lt={class:"input-group"},Bt={for:"coupon",class:"input-group-text bg-primary text-white fw-bold"},Ut={role:"status",class:"spinner-border spinner-border-sm me-2"},zt=i(()=>t("span",{class:"visually-hidden"},"Loading...",-1)),Ft=[zt],Mt=["disabled"],Dt=["disabled"],Ot={key:0},Pt=i(()=>t("b",null,"確認",-1)),At=[Pt],Ht={key:1,class:"bi bi-arrow-repeat"},Jt={class:"py-5 border-bottom-dotted"},Gt={class:"text-end fs-5 mb-0"},Kt=i(()=>t("span",null,"總計：NT＄",-1)),Rt={class:"text-end mt-5"},Wt={key:1,class:"alert bg-light text-center mb-0"};function Xt(s,e,d,g,n,r){const v=w("router-link"),S=w("order-form");return l(),c("div",M,[t("div",D,[t("div",O,[t("div",P,[s.carts.length?(l(),c(_,{key:0},[t("div",A,[t("div",{class:h(["nav-item h2 mb-0 shadow-sm",{active:n.step===1}])},G,2),K,t("div",{class:h(["nav-item h2 mb-0 shadow-sm",{active:n.step===2}])},X,2),Y,t("div",{class:h(["nav-item h2 mb-0 shadow-sm",{active:n.step===3}])},tt,2)]),t("div",st,[n.step===1?(l(),c(_,{key:0},[t("button",{type:"button",class:"btn btn-outline-primary rounded-1",onClick:e[0]||(e[0]=o=>s.$router.push("/products"))},[ot,u(" 繼續購物")]),t("button",{type:"button",onClick:e[1]||(e[1]=(...o)=>s.clearCart&&s.clearCart(...o)),class:"btn btn-outline-danger rounded-1"}," 清空購物車")],64)):m("",!0)]),n.step===1?(l(),c(_,{key:0},[t("div",et,[(l(!0),c(_,null,N(s.carts,o=>(l(),c("div",{key:o,class:"bg-white rounded-1 p-3 position-relative"},[t("div",it,[t("div",nt,[t("div",lt,[t("div",ct,[t("div",at,[k(v,{target:"_blank",to:`/product/${o.product.id}`},{default:C(()=>[t("img",{class:"card-img object-fit-cover",src:o.product.imageUrl,alt:o.product.title},null,8,dt),rt]),_:2},1032,["to"])])]),t("div",pt,[t("div",ut,[t("div",null,[t("p",null,[t("b",null,a(o.product.title),1)]),t("p",_t,a(o.product.content),1),t("p",ht,"單價 NT＄"+a(o.product.price),1)])])])])]),t("div",mt,[t("div",bt,[t("div",gt,[t("button",{type:"button",class:"input-group-text btn btn-primary",disabled:o.qty<=1,onClick:p=>r.changeCartQty(o.id,o.qty-1)},yt,8,vt),t("input",{onInput:e[2]||(e[2]=(...p)=>s.checkQty&&s.checkQty(...p)),type:"number",class:"form-control py-1 text-center",min:"1",value:o.qty,onChange:p=>r.changeCartQty(o.id,+p.target.value)},null,40,kt),t("button",{type:"button",class:"input-group-text btn btn-primary",onClick:p=>r.changeCartQty(o.id,o.qty+1)},xt,8,Ct)]),t("div",Tt,[t("p",St,[t("b",null,"NT＄"+a(o.total),1)])])])])]),t("div",qt,[t("button",{type:"button",class:"btn btn-sm btn-remove btn-primary rounded-1 shadow-sm",onClick:p=>s.deleteSingleCart(o.id)},Vt,8,Et)])]))),128))]),t("div",jt,[t("div",It,[t("div",Qt,[t("div",Lt,[t("label",Bt,[b(t("div",Ut,Ft,512),[[x,!!s.loadingTask]]),u(" "+a(r.couponLabelText),1)]),b(t("input",{id:"coupon",type:"text",class:"form-control","onUpdate:modelValue":e[3]||(e[3]=o=>n.couponCode=o),disabled:s.loadingTask||!n.couponEditable},null,8,Mt),[[Q,n.couponCode,void 0,{trim:!0}]]),t("button",{type:"button",class:"btn btn-primary",onClick:e[4]||(e[4]=(...o)=>r.checkCoupon&&r.checkCoupon(...o)),disabled:!!s.loadingTask},[n.couponEditable?(l(),c("span",Ot,At)):(l(),c("i",Ht))],8,Dt)])])])]),t("div",Jt,[t("p",Gt,[Kt,t("span",{class:h(s.sum.final_total!==s.sum.total?n.couponUsed:"")},a(s.sum.total),3),b(t("span",{class:"ms-1"},a(s.sum.finalTotal),513),[[x,s.sum.final_total!==s.sum.total]])])])],64)):n.step===2?(l(),V(S,{key:1})):m("",!0),t("div",Rt,[n.step===1?(l(),c("button",{key:0,type:"button",class:"btn btn-highlight",onClick:e[5]||(e[5]=o=>n.step+=1)},"下一步")):m("",!0)])],64)):(l(),c("div",Wt,[u(" 購物車空空如也！ 去"),k(v,{class:"text-info",to:"/products"},{default:C(()=>[u("逛逛")]),_:1}),u("吧！ ")]))])])])])}const vs=T(F,[["render",Xt],["__scopeId","data-v-0bd6a49d"]]);export{vs as default};
