import{C as u,P as E}from"./@ckeditor_ckeditor5-core@41.1.0-FknGk_Vk.js";import{e as v}from"./@ckeditor_ckeditor5-utils@41.1.0-D1rfIdEO.js";import{O as b,B as S,d as C}from"./@ckeditor_ckeditor5-engine@41.1.0-B08yYX20.js";/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function*p(s,e){for(const t of e)t&&s.getAttributeProperties(t[0]).copyOnEnter&&(yield t)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class k extends u{execute(){this.editor.model.change(e=>{this.enterBlock(e),this.fire("afterExecute",{writer:e})})}enterBlock(e){const t=this.editor.model,n=t.document.selection,o=t.schema,i=n.isCollapsed,r=n.getFirstRange(),c=r.start.parent,a=r.end.parent;if(o.isLimit(c)||o.isLimit(a))return!i&&c==a&&t.deleteContent(n),!1;if(i){const l=p(e.model.schema,n.getAttributes());return f(e,r.start),e.setSelectionAttribute(l),!0}else{const l=!(r.start.isAtStart&&r.end.isAtEnd),g=c==a;if(t.deleteContent(n,{leaveUnmerged:l}),l){if(g)return f(e,n.focus),!0;e.setSelection(a,0)}}return!1}}function f(s,e){s.split(e),s.setSelection(e.parent.nextSibling,0)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const y={insertParagraph:{isSoft:!1},insertLineBreak:{isSoft:!0}};class h extends b{constructor(e){super(e);const t=this.document;let n=!1;t.on("keydown",(o,i)=>{n=i.shiftKey}),t.on("beforeinput",(o,i)=>{if(!this.isEnabled)return;let r=i.inputType;v.isSafari&&n&&r=="insertParagraph"&&(r="insertLineBreak");const c=i.domEvent,a=y[r];if(!a)return;const l=new S(t,"enter",i.targetRanges[0]);t.fire(l,new C(e,c,{isSoft:a.isSoft})),l.stop.called&&o.stop()})}observe(){}stopObserving(){}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class P extends E{static get pluginName(){return"Enter"}init(){const e=this.editor,t=e.editing.view,n=t.document;t.addObserver(h),e.commands.add("enter",new k(e)),this.listenTo(n,"enter",(o,i)=>{n.isComposing||i.preventDefault(),!i.isSoft&&(e.execute("enter"),t.scrollToTheSelection())},{priority:"low"})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class T extends u{execute(){const e=this.editor.model,t=e.document;e.change(n=>{B(e,n,t.selection),this.fire("afterExecute",{writer:n})})}refresh(){const e=this.editor.model,t=e.document;this.isEnabled=x(e.schema,t.selection)}}function x(s,e){if(e.rangeCount>1)return!1;const t=e.anchor;if(!t||!s.checkChild(t,"softBreak"))return!1;const n=e.getFirstRange(),o=n.start.parent,i=n.end.parent;return!((d(o,s)||d(i,s))&&o!==i)}function B(s,e,t){const n=t.isCollapsed,o=t.getFirstRange(),i=o.start.parent,r=o.end.parent,c=i==r;if(n){const a=p(s.schema,t.getAttributes());m(s,e,o.end),e.removeSelectionAttribute(t.getAttributeKeys()),e.setSelectionAttribute(a)}else{const a=!(o.start.isAtStart&&o.end.isAtEnd);s.deleteContent(t,{leaveUnmerged:a}),c?m(s,e,t.focus):a&&e.setSelection(r,0)}}function m(s,e,t){const n=e.createElement("softBreak");s.insertContent(n,t),e.setSelection(n,"after")}function d(s,e){return s.is("rootElement")?!1:e.isLimit(s)||d(s.parent,e)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class D extends E{static get pluginName(){return"ShiftEnter"}init(){const e=this.editor,t=e.model.schema,n=e.conversion,o=e.editing.view,i=o.document;t.register("softBreak",{allowWhere:"$text",isInline:!0}),n.for("upcast").elementToElement({model:"softBreak",view:"br"}),n.for("downcast").elementToElement({model:"softBreak",view:(r,{writer:c})=>c.createEmptyElement("br")}),o.addObserver(h),e.commands.add("shiftEnter",new T(e)),this.listenTo(i,"enter",(r,c)=>{i.isComposing||c.preventDefault(),c.isSoft&&(e.execute("shiftEnter"),o.scrollToTheSelection())},{priority:"low"})}}export{P as E,D as S};
