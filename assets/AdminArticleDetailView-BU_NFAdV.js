import{b as E}from"./@ckeditor_ckeditor5-vue@5.1.0-BEtXLgA-.js";import{C as T}from"./@ckeditor_ckeditor5-editor-classic@41.1.0-CjgmXQJp.js";import{E as F}from"./@ckeditor_ckeditor5-essentials@41.1.0-BMaoBvmD.js";import{B as M,I as D}from"./@ckeditor_ckeditor5-basic-styles@41.1.0-BZcNm6b9.js";import"./@ckeditor_ckeditor5-utils@41.1.0-D1rfIdEO.js";import"./@ckeditor_ckeditor5-core@41.1.0-FknGk_Vk.js";import"./@ckeditor_ckeditor5-engine@41.1.0-B08yYX20.js";import"./@ckeditor_ckeditor5-ui@41.1.0-2hHT-dCQ.js";import"./color-convert@2.0.1-DXsnUphg.js";import{L as H}from"./@ckeditor_ckeditor5-link@41.1.0-DiJrHXcG.js";import"./@ckeditor_ckeditor5-widget@41.1.0-C64xDUSu.js";import"./@ckeditor_ckeditor5-clipboard@41.1.0-CMqnNSeC.js";import{H as L}from"./@ckeditor_ckeditor5-heading@41.1.0-b8O7lZcE.js";import"./@ckeditor_ckeditor5-paragraph@41.1.0-CNQ7__tG.js";import{F as N}from"./@ckeditor_ckeditor5-font@41.1.0-CfGQZr-1.js";import{I as R,a as B,b as z,c as j,d as O,e as W,f as J,g as Q}from"./@ckeditor_ckeditor5-image@41.1.0-B5HKNr8A.js";import{m as G,a as v}from"./pinia@2.1.7_vue@3.4.19-BGrtT45R.js";import{a as A}from"./adminArticle-D2DPJtTb.js";import{l as K,a as X}from"./alert-Dw2Xe9FX.js";import{U as Y}from"./UploadForm-DVkSiPeH.js";import{m as g,v as w,l as Z}from"./@vue_runtime-dom@3.4.19-Jk3xLe3-.js";import{_ as $}from"./index-lOBDqVH4.js";import{A as r,Q as e,c as s,aH as x,F as _,aq as p,z as a,W as U,aJ as m,P as u,ao as I}from"./@vue_runtime-core@3.4.19-CKRBtKAL.js";import{n as k,P as f}from"./@vue_shared@3.4.19-Bk7MlA8B.js";import"./vue@3.4.19-C3VIO2t_.js";import"./@vue_reactivity@3.4.19-Ddpy7v_1.js";import"./@ckeditor_ckeditor5-watchdog@41.1.0-BTEe3efs.js";import"./lodash-es@4.17.21-DPYE078p.js";import"./@ckeditor_ckeditor5-typing@41.1.0-JwUvPBia.js";import"./@ckeditor_ckeditor5-enter@41.1.0-DKoyJR1F.js";import"./@ckeditor_ckeditor5-select-all@41.1.0-BRHAnBYz.js";import"./@ckeditor_ckeditor5-undo@41.1.0-Lsp9vLJm.js";import"./color-parse@1.4.2-BwuI8Xag.js";import"./color-name@1.1.4-Bu07Fsda.js";import"./vanilla-colorful@0.7.2-PEGE98j7.js";import"./@ckeditor_ckeditor5-upload@41.1.0-COyVxUdm.js";import"./vue-demi@0.14.7_vue@3.4.19-Dq6ymT-8.js";import"./axios@1.6.7-Di5RpEPX.js";import"./sweetalert2@11.10.5-Csd-Z1-j.js";import"./ClipboardComponent-Cp7Pp_k5.js";import"./clipboard@2.0.11-Bt85-y58.js";/* empty css                               */import"./vee-validate@4.12.5_vue@3.4.19-BmIHdE2I.js";import"./@vee-validate_rules@4.12.5_vue@3.4.19-DqtB_02U.js";import"./@vee-validate_i18n@4.12.5-DXNnfMG0.js";import"./vue-axios@3.5.2_axios@1.6.7_vue@3.4.19-BaogFJPH.js";import"./moment@2.30.1-Cl4UOzQZ.js";import"./vue-loading-overlay@6.0.4_vue@3.4.19-DaNcwJXO.js";import"./vue-router@4.2.5_vue@3.4.19-BBAnl9m5.js";const c=["mb-3"],ee={options:[{model:"paragraph",view:{name:"p",classes:["fs-6",...c]},title:"paragraph"},{model:"heading1",view:{name:"h2",classes:["fs-2",...c]},title:"bootstrap - H2"},{model:"heading2",view:{name:"h3",classes:["fs-3",...c]},title:"bootstrap - H3"},{model:"heading3",view:{name:"h4",classes:["fs-4",...c]},title:"bootstrap - H4"},{model:"heading4",view:{name:"h5",classes:["fs-5",...c]},title:"bootstrap - H5"},{model:"text",view:{name:"p",classes:["fs-7",...c]},title:"small text"}]},te={data(){return{editor:T,editorConfig:{plugins:[F,M,D,H,L,N,R,B,z,j,O,W,J,Q],toolbar:{items:["undo","redo","|","heading","bold","italic","fontFamily","fontColor","|","link","|","insertImage"]},link:{decorators:{openInNewTab:{mode:"manual",defaultValue:!0,attributes:{target:"_blank",rel:"noopener noreferrer"},label:"是否另開新視窗"}}},image:{insert:{integrations:["assetManger","url"]},toolbar:["imageTextAlternative","imageStyle:inline","imageStyle:block","imageStyle:side"]},heading:ee}}}};var ie={VITE_APP_SITE:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"ataraxia",BASE_URL:"/2024-Art-Webshop-Project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_SITE:oe,VITE_APP_PATH:le}=ie,se={mixins:[te],components:{ckeditor:E.component,UploadForm:Y},data(){return{tab:"setting",article:{},type:"",uploadState:!1}},computed:{...G(A,["categories"]),createAt:{get(){return this.$calc.formatDate(this.article.create_at*1e3)},set(l){this.article.create_at=new Date(l).getTime()/1e3}}},methods:{...v(A,["createArticle","updateArticle"]),...v(K,["createLoader","removeLoader"]),...v(X,["errorAlert"]),getArticle(l){this.createLoader("get-single-article"),this.$http.get(`${oe}/api/${le}/admin/article/${l}`).then(i=>{const{article:b}=i.data;this.article=b,this.type=b.type}).catch(i=>this.errorAlert(i)).finally(()=>this.removeLoader("get-single-article"))},updateData(){this.article.tag=Array.isArray(this.article.tag)?[...this.article.tag]:[],this.type==="網站公告"&&(this.article.author="收藏家工作室")},confirmUpdate(){this.type==="公益計劃"&&(this.article.content="無"),this.type==="網站公告"&&(this.article.description="無"),this.article.tag=this.article.tag.filter(l=>l),this.article.type=this.type,this.article.id?this.updateArticle(this.article):this.createArticle(this.article)},addNewImage(l){this.article.image=l},updateUploadState(l){this.uploadState=l}},watch:{article(){this.updateData()}},mounted(){this.type=this.$route.params.type,this.$route.query.id?this.getArticle(this.$route.query.id):this.article={isPublic:!1,create_at:this.$calc.now()}}},re={class:"nav nav-pills bg-gray rounded-2 mb-7"},ae={class:"nav-item flex-grow-1"},ne={class:"nav-item flex-grow-1"},me={class:"nav-item flex-grow-1"},ce={class:"d-flex align-items-end gap-2 mb-7"},de={class:"mb-0"},pe={class:"mb-5"},ue={class:"form-label is-required",for:"title"},fe={class:"mb-5"},he={class:"row row-cols-2"},ge={class:"col"},_e={class:"form-label is-required",for:"author"},be={class:"col"},ye=e("label",{class:"form-label is-required",for:"create_at"},[e("span",null,"發表日期")],-1),ve={key:0,class:"mb-5"},ke=e("label",{for:"link",class:"form-label is-required"},"網站連結",-1),Ve={key:1,class:"mb-5"},Ae=e("label",{for:"description",class:"form-label is-required"},"摘要",-1),we={key:2,class:"form-check mb-5"},xe=e("label",{for:"recommend",class:"form-label"},"是否需要推薦商品",-1),Ue=e("p",{class:"fs-7 text-muted"},"建議：新聞專欄不需要推薦商品喔！",-1),Ie={class:"mb-5"},Se=e("label",{for:"category",class:"form-label is-required"},[e("span",null,"分類")],-1),Pe={id:"categories"},Ce=["value"],qe={class:"mb-5"},Ee=e("p",null,"標籤",-1),Te=e("p",{class:"fs-7 text-muted"},"選擇和商品一致的標籤，就能向客戶推薦相關商品喔！",-1),Fe={class:"row gy-3 mb-3"},Me=["onUpdate:modelValue"],De=["onClick"],He=e("i",{class:"bi bi-x-lg"},null,-1),Le=[He],Ne={class:"mb-5"},Re=e("label",{class:"form-label is-required",for:"image"},"圖片",-1),Be=["href"],ze=["src","alt"],je=e("hr",null,null,-1),Oe=e("hr",null,null,-1),We=e("p",{class:"is-required"},"詳細內容",-1),Je=e("hr",null,null,-1),Qe={class:"alert bg-light flex-classic mt-5 mb-0"},Ge={class:"form-check"},Ke=e("label",{class:"form-label mb-0",for:"isPublic"},"是否公開",-1),Xe=["disabled"];function Ye(l,i,b,Ze,t,d){const S=p("RouterLink"),n=p("VField"),P=p("UploadForm"),C=p("ckeditor"),q=p("VForm");return a(),r(_,null,[e("ul",re,[e("li",ae,[e("button",{type:"button",onClick:i[0]||(i[0]=h=>t.tab="setting"),class:k(["w-100 nav-link",{active:t.tab==="setting"}])}," 設定",2)]),e("li",ne,[e("button",{type:"button",onClick:i[1]||(i[1]=h=>t.tab="category"),class:k(["w-100 nav-link",{active:t.tab==="category"}])}," 分類",2)]),e("li",me,[e("button",{type:"button",onClick:i[2]||(i[2]=h=>t.tab="image"),class:k(["w-100 nav-link",{active:t.tab==="image"}])}," 圖片",2)])]),s(q,{onSubmit:d.confirmUpdate,ref:"form"},{default:x(({meta:h})=>[e("div",ce,[e("h4",de,[e("b",null,f(t.article.id?"編輯":"新增")+f(t.type),1)]),U("/ "),s(S,{to:"/admin/article",class:"text-info"},{default:x(()=>[U("回文章管理列表")]),_:1})]),m(e("div",null,[e("div",pe,[e("label",ue,[e("span",null,f(t.type==="公益計劃"?"組織名稱":"標題"),1)]),s(n,{id:"title",type:"text",class:"form-control",modelValue:t.article.title,"onUpdate:modelValue":i[3]||(i[3]=o=>t.article.title=o),modelModifiers:{trim:!0},name:"title",rules:"required"},null,8,["modelValue"])]),e("div",fe,[e("div",he,[e("div",ge,[e("label",_e,[e("span",null,f(t.type==="公益計劃"?"完整法人名稱":"作者"),1)]),s(n,{id:"author",type:"text",class:"form-control",modelValue:t.article.author,"onUpdate:modelValue":i[4]||(i[4]=o=>t.article.author=o),modelModifiers:{trim:!0},name:"author",rules:"required"},null,8,["modelValue"])]),e("div",be,[ye,s(n,{id:"create_at",type:"date",class:"form-control",modelValue:d.createAt,"onUpdate:modelValue":i[5]||(i[5]=o=>d.createAt=o),name:"create_at",rules:"required"},null,8,["modelValue"])])])]),t.type==="公益計劃"?(a(),r("div",ve,[ke,s(n,{id:"link",type:"text",class:"form-control",modelValue:t.article.link,"onUpdate:modelValue":i[6]||(i[6]=o=>t.article.link=o),modelModifiers:{trim:!0},name:"link",rules:"required|url",placeholder:"請提供該組織的官方連結，讓使用者可以透過連結拜訪"},null,8,["modelValue"])])):u("",!0),t.type!=="網站公告"?(a(),r("div",Ve,[Ae,s(n,{id:"title",rows:"4",class:"form-control",modelValue:t.article.description,"onUpdate:modelValue":i[7]||(i[7]=o=>t.article.description=o),modelModifiers:{trim:!0},name:"description",as:"textarea"},null,8,["modelValue"])])):u("",!0),t.type==="專欄文章"?(a(),r("div",we,[m(e("input",{type:"checkbox",id:"recommend",class:"form-check-input","onUpdate:modelValue":i[8]||(i[8]=o=>t.article.recommend=o)},null,512),[[w,t.article.recommend]]),xe,Ue])):u("",!0)],512),[[g,t.tab==="setting"]]),m(e("div",null,[e("div",Ie,[Se,s(n,{id:"category",class:"form-control",list:"categories",modelValue:t.article.category,"onUpdate:modelValue":i[9]||(i[9]=o=>t.article.category=o),modelModifiers:{trim:!0},name:"category",rules:"required"},null,8,["modelValue"]),e("datalist",Pe,[(a(!0),r(_,null,I(l.categories[t.type],o=>(a(),r("option",{key:o,value:o},f(o),9,Ce))),128))])]),m(e("div",qe,[Ee,Te,e("div",Fe,[(a(!0),r(_,null,I(t.article.tag,(o,y)=>(a(),r("div",{class:"col-md-3 position-relative",key:o},[m(e("input",{type:"text",class:"form-control","onUpdate:modelValue":V=>t.article.tag[y]=V},null,8,Me),[[Z,t.article.tag[y]]]),e("button",{type:"button",class:"btn btn-origin btn-inline",onClick:V=>t.article.tag.splice(y,1)},Le,8,De)]))),128))]),e("button",{type:"button",class:"btn btn-primary",onClick:i[10]||(i[10]=o=>t.article.tag.push(""))}," 新增標籤")],512),[[g,t.type==="專欄文章"]])],512),[[g,t.tab==="category"]]),m(e("div",null,[e("div",Ne,[Re,s(n,{id:"image",type:"text",class:"form-control",modelValue:t.article.image,"onUpdate:modelValue":i[11]||(i[11]=o=>t.article.image=o),modelModifiers:{trim:!0},name:"image",rules:"required|url"},null,8,["modelValue"]),t.article.image?(a(),r("a",{key:0,target:"_blank",href:t.article.image},[e("img",{class:"object-fit-cover mt-3","max-height":"250",src:t.article.image,alt:t.article.title},null,8,ze)],8,Be)):u("",!0)]),je,s(P,{"use-clipboard":!1,"upload-state":t.uploadState,disabled:t.article.image,onAddNewImage:d.addNewImage,onUpdateUploadState:d.updateUploadState},null,8,["upload-state","disabled","onAddNewImage","onUpdateUploadState"])],512),[[g,t.tab==="image"]]),t.type!=="公益計劃"?(a(),r(_,{key:0},[Oe,We,s(C,{editor:l.editor,config:l.editorConfig,modelValue:t.article.content,"onUpdate:modelValue":i[12]||(i[12]=o=>t.article.content=o),modelModifiers:{trim:!0}},null,8,["editor","config","modelValue"])],64)):u("",!0),Je,e("div",Qe,[e("div",Ge,[m(e("input",{id:"isPublic",type:"checkbox",class:"form-check-input","onUpdate:modelValue":i[13]||(i[13]=o=>t.article.isPublic=o)},null,512),[[w,t.article.isPublic]]),Ke]),e("button",{type:"submit",class:"btn btn-primary",disabled:!h.valid},"確認更新 ",8,Xe)])]),_:1},8,["onSubmit"])],64)}const Gt=$(se,[["render",Ye]]);export{Gt as default};
