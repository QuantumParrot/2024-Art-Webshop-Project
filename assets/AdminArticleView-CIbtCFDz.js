import{m as S,a as b}from"./pinia@2.1.7_vue@3.4.19-4NNq-WPh.js";import{a as f}from"./adminArticle-C6P_5F7f.js";import{l as E}from"./loader-BKOny_iI.js";import{a as I}from"./alert-C8z9YHNp.js";import{b as D}from"./@ckeditor_ckeditor5-vue@5.1.0-CfUo4zCs.js";import{m as T}from"./modal-DN9v4sWv.js";import{C as H}from"./@ckeditor_ckeditor5-editor-classic@41.1.0-DQVgWH2R.js";import{E as L}from"./@ckeditor_ckeditor5-essentials@41.1.0-BRkwRk-Q.js";import{B as N,I as B}from"./@ckeditor_ckeditor5-basic-styles@41.1.0-5z_YNo6x.js";import"./@ckeditor_ckeditor5-utils@41.1.0-Cn-yVoWx.js";import"./@ckeditor_ckeditor5-core@41.1.0-D0yh88O_.js";import"./@ckeditor_ckeditor5-engine@41.1.0-CtehaBhy.js";import"./@ckeditor_ckeditor5-ui@41.1.0-BobjZqZd.js";import"./color-convert@2.0.1-CD9EpuSd.js";import{L as F}from"./@ckeditor_ckeditor5-link@41.1.0-MgD6u3mV.js";import"./@ckeditor_ckeditor5-widget@41.1.0-5WKYq610.js";import"./@ckeditor_ckeditor5-clipboard@41.1.0-TKWeGF3C.js";import{H as j}from"./@ckeditor_ckeditor5-heading@41.1.0-Bmd0_NOI.js";import"./@ckeditor_ckeditor5-paragraph@41.1.0-DrkwXWAs.js";import{F as O}from"./@ckeditor_ckeditor5-font@41.1.0-BCyHh6H2.js";import{U as R}from"./UploadForm-wXXIqvzG.js";import{m as w,l as z,v as $}from"./@vue_runtime-dom@3.4.19-DVfTC9pq.js";import{_ as P}from"./index-xG1ACHlj.js";import{aj as n,O as c,P as t,c as a,aH as C,aJ as u,F as k,ao as M,N as J,aq as m}from"./@vue_runtime-core@3.4.19-CzGklseq.js";import{n as A,P as h}from"./@vue_shared@3.4.19-Bk7MlA8B.js";import{P as W}from"./PaginationComponent-CXnoe1Ls.js";import"./vue-demi@0.14.7_vue@3.4.19-Dq6ymT-8.js";import"./@vue_reactivity@3.4.19-Ddpy7v_1.js";import"./axios@1.6.7-Di5RpEPX.js";import"./sweetalert2@11.10.5-szm5w3W2.js";import"./vue@3.4.19-dGbATgA4.js";import"./bootstrap@5.3.2_@popperjs_core@2.11.8-CZQLkDpL.js";import"./@popperjs_core@2.11.8-BZs4MIFD.js";import"./@ckeditor_ckeditor5-watchdog@41.1.0-B5W-sfM8.js";import"./lodash-es@4.17.21-C5qYGfgy.js";import"./@ckeditor_ckeditor5-typing@41.1.0-DSIargVI.js";import"./@ckeditor_ckeditor5-enter@41.1.0-CzFUQWGc.js";import"./@ckeditor_ckeditor5-select-all@41.1.0-B0rMbDhC.js";import"./@ckeditor_ckeditor5-undo@41.1.0-DSqU211Z.js";import"./color-parse@1.4.2-BZ9a-Bsn.js";import"./color-name@1.1.4-DInjB3q9.js";import"./vanilla-colorful@0.7.2-PEGE98j7.js";import"./clipboard@2.0.11-Dge1nvnO.js";/* empty css                               */import"./vee-validate@4.12.5_vue@3.4.19-CIwtLcK9.js";import"./@vee-validate_rules@4.12.5_vue@3.4.19-CtCrC8gK.js";import"./@vee-validate_i18n@4.12.5-DXNnfMG0.js";import"./vue-axios@3.5.2_axios@1.6.7_vue@3.4.19-BaogFJPH.js";import"./moment@2.30.1-Cl4UOzQZ.js";import"./vue-loading-overlay@6.0.4_vue@3.4.19-Ds2EadH1.js";import"./vue-router@4.2.5_vue@3.4.19-CGkOaO3i.js";const p=["mb-3"],G={options:[{model:"paragraph",view:{name:"p",classes:["fs-6",...p]},title:"paragraph"},{model:"heading1",view:{name:"h2",classes:["fs-2",...p]},title:"bootstrap - H2"},{model:"heading2",view:{name:"h3",classes:["fs-3",...p]},title:"bootstrap - H3"},{model:"heading3",view:{name:"h4",classes:["fs-4",...p]},title:"bootstrap - H4"},{model:"heading4",view:{name:"h5",classes:["fs-5",...p]},title:"bootstrap - H5"},{model:"text",view:{name:"p",classes:["fs-7",...p]},title:"small text"}]},K={data(){return{editor:H,editorConfig:{plugins:[L,N,B,F,j,O],toolbar:{items:["undo","redo","|","heading","bold","italic","fontSize","fontFamily","fontColor","|","link"]},heading:G}}}},Q={mixins:[T,K],components:{ckeditor:D.component,UploadForm:R},props:["tempArticle"],data(){return{tab:"setting",article:{},uploadState:!1}},computed:{...S(f,["categories"]),createAt:{get(){return this.$calc.formatDate(this.article.create_at*1e3)},set(i){this.article.create_at=new Date(i).getTime()/1e3}}},methods:{...b(f,["createArticle","updateArticle"]),updateData(){this.article=this.tempArticle,this.article.tag=Array.isArray(this.tempArticle.tag)?this.tempArticle.tag:[]},confirmUpdate(){this.article.tag=this.article.tag.filter(i=>i),this.article.id?this.updateArticle(this.article,this.hideModal):this.createArticle(this.article,this.hideModal)},addNewImage(i){this.article.image=i},updateUploadState(i){this.uploadState=i}},watch:{tempArticle(){this.updateData()}},mounted(){this.updateData()}},X={class:"modal modal-lg fade",tabindex:"-1",ref:"modal"},Y={class:"modal-dialog modal-dialog-centered"},Z={class:"modal-content"},tt={class:"modal-header justify-content-end"},et=t("i",{class:"bi bi-x-circle-fill"},null,-1),ot=[et],it={class:"modal-body"},lt={class:"nav nav-pills bg-gray rounded-2 mb-3"},st={class:"nav-item flex-grow-1"},at={class:"nav-item flex-grow-1"},rt={class:"nav-item flex-grow-1"},nt={class:"mb-3"},ct=t("label",{class:"form-label is-required",for:"title"},"文章標題",-1),dt={class:"mb-3"},mt=t("label",{class:"form-label is-required",for:"description"},"文章摘要",-1),pt={class:"mb-3"},ut={class:"row row-cols-2"},ht={class:"col"},_t=t("label",{class:"form-label is-required",for:"author"},"文章作者",-1),bt={class:"col"},ft={class:"mb-3"},gt=t("label",{class:"form-label is-required",for:"create_at"},[t("span",null,"發表日期")],-1),vt={class:"mb-3"},yt={class:"row row-cols-2"},wt={class:"col"},At=t("label",{class:"form-label is-required",for:"type"},"文章類型",-1),kt=t("option",{value:"",disabled:""},"請選擇文章類型",-1),Vt=t("option",{value:"網站公告"},"網站公告",-1),Ct=t("option",{value:"專欄文章"},"專欄文章",-1),St={class:"col"},Pt=t("label",{class:"form-label is-required",for:"category"},[t("span",null,"文章分類")],-1),Mt={class:"mb-3"},xt=t("p",null,"標籤",-1),Ut={class:"row gy-3 mb-3"},qt=["onUpdate:modelValue"],Et=["onClick"],It=t("i",{class:"bi bi-x-lg"},null,-1),Dt=[It],Tt={class:"mb-3"},Ht=t("label",{class:"form-label is-required",for:"image"},"文章圖片",-1),Lt=["src","alt"],Nt=t("hr",null,null,-1),Bt=t("hr",null,null,-1),Ft=t("p",{class:"is-required"},"文章內容",-1),jt={class:"modal-footer justify-content-between align-items-center"},Ot={class:"form-check"},Rt=t("label",{class:"form-label",for:"isPublic"}," 是否公開",-1),zt=["disabled"];function $t(i,o,x,U,e,d){const g=m("loading-overlay"),r=m("v-field"),s=m("upload-form"),_=m("ckeditor"),q=m("v-form");return n(),c("div",X,[t("div",Y,[a(g,{"is-loading":e.uploadState,"is-full":!1},null,8,["is-loading"]),t("div",Z,[t("div",tt,[t("button",{type:"button",class:"btn border-0 p-0 fs-4",onClick:o[0]||(o[0]=(...v)=>i.hideModal&&i.hideModal(...v))},ot)]),a(q,{onSubmit:d.confirmUpdate,ref:"form"},{default:C(({meta:v})=>[t("div",it,[t("ul",lt,[t("li",st,[t("button",{type:"button",onClick:o[1]||(o[1]=l=>e.tab="setting"),class:A(["w-100 nav-link",{active:e.tab==="setting"}])}," 文章設定",2)]),t("li",at,[t("button",{type:"button",onClick:o[2]||(o[2]=l=>e.tab="category"),class:A(["w-100 nav-link",{active:e.tab==="category"}])}," 文章分類",2)]),t("li",rt,[t("button",{type:"button",onClick:o[3]||(o[3]=l=>e.tab="image"),class:A(["w-100 nav-link",{active:e.tab==="image"}])}," 文章圖片",2)])]),u(t("div",null,[t("div",nt,[ct,a(r,{id:"title",type:"text",class:"form-control",modelValue:e.article.title,"onUpdate:modelValue":o[4]||(o[4]=l=>e.article.title=l),modelModifiers:{trim:!0},name:"title",rules:"required"},null,8,["modelValue"])]),t("div",dt,[mt,a(r,{id:"title",rows:"3",class:"form-control",modelValue:e.article.description,"onUpdate:modelValue":o[5]||(o[5]=l=>e.article.description=l),modelModifiers:{trim:!0},name:"description",as:"textarea"},null,8,["modelValue"])]),t("div",pt,[t("div",ut,[t("div",ht,[_t,a(r,{id:"author",type:"text",class:"form-control",modelValue:e.article.author,"onUpdate:modelValue":o[6]||(o[6]=l=>e.article.author=l),modelModifiers:{trim:!0},name:"author",rules:"required"},null,8,["modelValue"])]),t("div",bt,[t("div",ft,[gt,a(r,{id:"create_at",type:"date",class:"form-control",modelValue:d.createAt,"onUpdate:modelValue":o[7]||(o[7]=l=>d.createAt=l),name:"create_at",rules:"required"},null,8,["modelValue"])])])])])],512),[[w,e.tab==="setting"]]),u(t("div",null,[t("div",vt,[t("div",yt,[t("div",wt,[At,a(r,{id:"type",class:"form-select",modelValue:e.article.type,"onUpdate:modelValue":o[8]||(o[8]=l=>e.article.type=l),name:"type",rules:"required",as:"select"},{default:C(()=>[kt,Vt,Ct]),_:1},8,["modelValue"])]),t("div",St,[Pt,a(r,{id:"category",class:"form-control",modelValue:e.article.category,"onUpdate:modelValue":o[9]||(o[9]=l=>e.article.category=l),modelModifiers:{trim:!0},name:"category",rules:"required"},null,8,["modelValue"])])])]),t("div",Mt,[xt,t("div",Ut,[(n(!0),c(k,null,M(e.article.tag,(l,y)=>(n(),c("div",{class:"col-md-3 position-relative",key:l},[u(t("input",{type:"text",class:"form-control","onUpdate:modelValue":V=>e.article.tag[y]=V},null,8,qt),[[z,e.article.tag[y]]]),t("button",{type:"button",class:"btn btn-origin btn-inline",onClick:V=>e.article.tag.splice(y,1)},Dt,8,Et)]))),128))]),t("button",{type:"button",class:"btn btn-primary",onClick:o[10]||(o[10]=l=>e.article.tag.push(""))}," 新增標籤")])],512),[[w,e.tab==="category"]]),u(t("div",null,[t("div",Tt,[Ht,a(r,{id:"image",type:"text",class:"form-control",modelValue:e.article.image,"onUpdate:modelValue":o[11]||(o[11]=l=>e.article.image=l),modelModifiers:{trim:!0},name:"image",rules:"required|url"},null,8,["modelValue"]),e.article.image?(n(),c("img",{key:0,class:"mt-3",src:e.article.image,alt:e.article.title},null,8,Lt)):J("",!0)]),Nt,a(s,{"use-clipboard":!1,"upload-state":e.uploadState,disabled:e.article.image,onAddNewImage:d.addNewImage,onUpdateUploadState:d.updateUploadState},null,8,["upload-state","disabled","onAddNewImage","onUpdateUploadState"])],512),[[w,e.tab==="image"]]),Bt,Ft,a(_,{editor:i.editor,config:i.editorConfig,modelValue:e.article.content,"onUpdate:modelValue":o[12]||(o[12]=l=>e.article.content=l)},null,8,["editor","config","modelValue"])]),t("div",jt,[t("div",Ot,[u(t("input",{id:"isPublic",type:"checkbox",class:"form-check-input","onUpdate:modelValue":o[13]||(o[13]=l=>e.article.isPublic=l)},null,512),[[$,e.article.isPublic]]),Rt]),t("div",null,[t("button",{type:"submit",class:"btn btn-primary me-2",disabled:!v.valid},"確認更新",8,zt),t("button",{type:"button",class:"btn btn-outline-secondary",onClick:o[14]||(o[14]=(...l)=>i.hideModal&&i.hideModal(...l))},"取消")])])]),_:1},8,["onSubmit"])])])],512)}const Jt=P(Q,[["render",$t]]);var Wt={VITE_APP_SITE:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"ataraxia",BASE_URL:"/2024-Art-Webshop-Project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_SITE:Gt,VITE_APP_PATH:Kt}=Wt,Qt={components:{AdminArticleModal:Jt,PaginationComponent:W},data(){return{tempArticle:{}}},computed:{...S(f,["articles","article","pagination"])},methods:{...b(f,["getArticles","getArticle","deleteArticle","switchArticleStatus"]),...b(E,["createLoader","removeLoader"]),...b(I,["errorAlert"]),openModal(i){i?this.getArticle(i):this.tempArticle={isPublic:!1,create_at:this.$calc.now()},this.$refs.articleModal.showModal()},getArticle(i){this.createLoader("get-single-article"),this.$http.get(`${Gt}/api/${Kt}/admin/article/${i}`).then(o=>{this.tempArticle=o.data.article}).catch(o=>this.errorAlert(o)).finally(()=>this.removeLoader("get-single-article"))}},mounted(){this.getArticles()}},Xt={class:"text-end mb-7"},Yt=t("h3",{class:"fs-2 mb-2"},"文章",-1),Zt={class:"text-muted"},te={class:"alert bg-gray flex-classic mb-5"},ee={key:0,class:"table-responsive"},oe={class:"table table-hover text-nowrap"},ie=t("thead",null,[t("tr",null,[t("th",{scope:"col",width:"10%"},"日期"),t("th",{scope:"col",width:"10%"},"分類"),t("th",{scope:"col",width:"50%"},"文章"),t("th",{scope:"col",width:"15%",class:"text-center"},"狀態"),t("th",{scope:"col",width:"15%",class:"text-center"},"處理")])],-1),le={class:"align-middle"},se={class:"badge bg-highlight text-dark py-2"},ae={class:"fw-bold mb-2"},re={class:"text-muted fs-7"},ne={class:"text-center"},ce={class:"form-switch"},de=["checked","onChange"],me={class:"text-center"},pe={class:"d-flex flex-column gap-2"},ue=["onClick"],he=["onClick"],_e={key:1,class:"alert bg-gray"};function be(i,o,x,U,e,d){const g=m("pagination-component"),r=m("admin-article-modal");return n(),c(k,null,[t("div",Xt,[Yt,t("p",Zt,"目前共有 "+h(i.articles.length)+" 篇文章 (꜆꜄꜆ ˙꒳˙)꜆꜄꜆ｵﾗｵﾗｵﾗｵﾗ",1)]),t("div",te,[t("div",null,[t("button",{type:"button",class:"btn btn-highlight",onClick:o[0]||(o[0]=s=>d.openModal())},"新增文章")]),a(g,{current:i.pagination.current_page,total:i.pagination.total_pages,onSwitchPage:i.getArticles},null,8,["current","total","onSwitchPage"])]),i.articles.length?(n(),c("div",ee,[t("table",oe,[ie,t("tbody",le,[(n(!0),c(k,null,M(i.articles,s=>(n(),c("tr",{key:s.id},[t("td",null,h(i.$calc.formatDate(s.create_at*1e3,"/")),1),t("td",null,[t("span",se,h(s.type),1)]),t("td",null,[t("p",ae,h(s.title),1),t("span",re,"作者｜"+h(s.author),1)]),t("td",ne,[t("div",ce,[t("input",{type:"checkbox",role:"switch",class:"form-check-input",checked:s.isPublic,onChange:_=>i.switchArticleStatus(s)},null,40,de)])]),t("td",me,[t("div",pe,[t("button",{type:"button",class:"w-100 btn btn-outline-secondary",onClick:_=>d.openModal(s.id)}," 編輯",8,ue),t("button",{type:"button",class:"w-100 btn btn-outline-danger",onClick:_=>i.deleteArticle(s.id,s.title)}," 刪除",8,he)])])]))),128))])])])):(n(),c("div",_e,"還沒有任何文章！趕快新增一篇吧！")),a(r,{ref:"articleModal","temp-article":e.tempArticle},null,8,["temp-article"])],64)}const _o=P(Qt,[["render",be]]);export{_o as default};
