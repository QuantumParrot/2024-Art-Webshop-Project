import{m as P,a as f}from"./pinia@2.1.7_vue@3.4.19-4NNq-WPh.js";import{a as g}from"./adminArticle-C6P_5F7f.js";import{l as E}from"./loader-BKOny_iI.js";import{a as D}from"./alert-C8z9YHNp.js";import{b as T}from"./@ckeditor_ckeditor5-vue@5.1.0-CfUo4zCs.js";import{m as H,P as L}from"./modal-COSgdlSd.js";import{C as N}from"./@ckeditor_ckeditor5-editor-classic@41.1.0-DQVgWH2R.js";import{E as B}from"./@ckeditor_ckeditor5-essentials@41.1.0-BRkwRk-Q.js";import{B as F,I as j}from"./@ckeditor_ckeditor5-basic-styles@41.1.0-5z_YNo6x.js";import"./@ckeditor_ckeditor5-utils@41.1.0-Cn-yVoWx.js";import"./@ckeditor_ckeditor5-core@41.1.0-D0yh88O_.js";import"./@ckeditor_ckeditor5-engine@41.1.0-CtehaBhy.js";import"./@ckeditor_ckeditor5-ui@41.1.0-BobjZqZd.js";import"./color-convert@2.0.1-CD9EpuSd.js";import{L as O}from"./@ckeditor_ckeditor5-link@41.1.0-MgD6u3mV.js";import"./@ckeditor_ckeditor5-widget@41.1.0-5WKYq610.js";import"./@ckeditor_ckeditor5-clipboard@41.1.0-TKWeGF3C.js";import{H as R}from"./@ckeditor_ckeditor5-heading@41.1.0-Bmd0_NOI.js";import"./@ckeditor_ckeditor5-paragraph@41.1.0-DrkwXWAs.js";import{F as z}from"./@ckeditor_ckeditor5-font@41.1.0-BCyHh6H2.js";import{U as $}from"./UploadForm-hr3HTO3f.js";import{m as A,l as J,v as W}from"./@vue_runtime-dom@3.4.19-DVfTC9pq.js";import{_ as M}from"./index-kzKWix_k.js";import{aj as c,O as d,P as t,c as r,aH as C,aJ as h,F as V,ao as x,N as G,aq as p,al as K,ak as Q}from"./@vue_runtime-core@3.4.19-CzGklseq.js";import{n as k,P as _}from"./@vue_shared@3.4.19-Bk7MlA8B.js";import"./vue-demi@0.14.7_vue@3.4.19-Dq6ymT-8.js";import"./@vue_reactivity@3.4.19-Ddpy7v_1.js";import"./axios@1.6.7-Di5RpEPX.js";import"./sweetalert2@11.10.5-szm5w3W2.js";import"./vue@3.4.19-dGbATgA4.js";import"./bootstrap@5.3.2_@popperjs_core@2.11.8-CZQLkDpL.js";import"./@popperjs_core@2.11.8-BZs4MIFD.js";import"./@ckeditor_ckeditor5-watchdog@41.1.0-B5W-sfM8.js";import"./lodash-es@4.17.21-C5qYGfgy.js";import"./@ckeditor_ckeditor5-typing@41.1.0-DSIargVI.js";import"./@ckeditor_ckeditor5-enter@41.1.0-CzFUQWGc.js";import"./@ckeditor_ckeditor5-select-all@41.1.0-B0rMbDhC.js";import"./@ckeditor_ckeditor5-undo@41.1.0-DSqU211Z.js";import"./color-parse@1.4.2-BZ9a-Bsn.js";import"./color-name@1.1.4-DInjB3q9.js";import"./vanilla-colorful@0.7.2-PEGE98j7.js";import"./clipboard@2.0.11-Dge1nvnO.js";/* empty css                               */import"./vee-validate@4.12.5_vue@3.4.19-CIwtLcK9.js";import"./@vee-validate_rules@4.12.5_vue@3.4.19-CtCrC8gK.js";import"./@vee-validate_i18n@4.12.5-DXNnfMG0.js";import"./vue-axios@3.5.2_axios@1.6.7_vue@3.4.19-BaogFJPH.js";import"./moment@2.30.1-Cl4UOzQZ.js";import"./vue-loading-overlay@6.0.4_vue@3.4.19-Ds2EadH1.js";import"./vue-router@4.2.5_vue@3.4.19-CGkOaO3i.js";const u=["mb-3"],X={options:[{model:"paragraph",view:{name:"p",classes:["fs-6",...u]},title:"paragraph"},{model:"heading1",view:{name:"h2",classes:["fs-2",...u]},title:"bootstrap - H2"},{model:"heading2",view:{name:"h3",classes:["fs-3",...u]},title:"bootstrap - H3"},{model:"heading3",view:{name:"h4",classes:["fs-4",...u]},title:"bootstrap - H4"},{model:"heading4",view:{name:"h5",classes:["fs-5",...u]},title:"bootstrap - H5"},{model:"text",view:{name:"p",classes:["fs-7",...u]},title:"small text"}]},Y={data(){return{editor:N,editorConfig:{plugins:[B,F,j,O,R,z],toolbar:{items:["undo","redo","|","heading","bold","italic","fontSize","fontFamily","fontColor","|","link"]},heading:X}}}},Z={mixins:[H,Y],components:{ckeditor:T.component,UploadForm:$},props:["tempArticle"],data(){return{tab:"setting",article:{},uploadState:!1}},computed:{...P(g,["categories"]),createAt:{get(){return this.$calc.formatDate(this.article.create_at*1e3)},set(i){this.article.create_at=new Date(i).getTime()/1e3}}},methods:{...f(g,["createArticle","updateArticle"]),updateData(){this.article=this.tempArticle,this.article.tag=Array.isArray(this.tempArticle.tag)?this.tempArticle.tag:[]},confirmUpdate(){this.article.tag=this.article.tag.filter(i=>i),this.article.id?this.updateArticle(this.article,this.hideModal):this.createArticle(this.article,this.hideModal)},addNewImage(i){this.article.image=i},updateUploadState(i){this.uploadState=i}},watch:{tempArticle(){this.updateData()}},mounted(){this.updateData()}},s=i=>(K("data-v-86d5cafd"),i=i(),Q(),i),tt={class:"modal modal-lg fade",tabindex:"-1",ref:"modal"},et={class:"modal-dialog modal-dialog-centered"},ot={class:"modal-content"},it={class:"modal-header justify-content-end"},lt=s(()=>t("i",{class:"bi bi-x-circle-fill"},null,-1)),st=[lt],at={class:"modal-body"},rt={class:"nav nav-pills bg-gray rounded-2 mb-3"},nt={class:"nav-item flex-grow-1"},ct={class:"nav-item flex-grow-1"},dt={class:"nav-item flex-grow-1"},mt={class:"mb-3"},pt=s(()=>t("label",{class:"form-label is-required",for:"title"},"文章標題",-1)),ut={class:"mb-3"},ht=s(()=>t("label",{class:"form-label is-required",for:"description"},"文章摘要",-1)),_t={class:"mb-3"},bt={class:"row row-cols-2"},ft={class:"col"},gt=s(()=>t("label",{class:"form-label is-required",for:"author"},"文章作者",-1)),vt={class:"col"},yt={class:"mb-3"},wt=s(()=>t("label",{class:"form-label is-required",for:"create_at"},[t("span",null,"發表日期")],-1)),At={class:"mb-3"},kt={class:"row row-cols-2"},Vt={class:"col"},St=s(()=>t("label",{class:"form-label is-required",for:"type"},"文章類型",-1)),Ct=s(()=>t("option",{value:"",disabled:""},"請選擇文章類型",-1)),Pt=s(()=>t("option",{value:"網站公告"},"網站公告",-1)),Mt=s(()=>t("option",{value:"專欄文章"},"專欄文章",-1)),xt={class:"col"},Ut=s(()=>t("label",{class:"form-label is-required",for:"category"},[t("span",null,"文章分類")],-1)),It={class:"mb-3"},qt=s(()=>t("p",null,"標籤",-1)),Et={class:"row gy-3 mb-3"},Dt=["onUpdate:modelValue"],Tt=["onClick"],Ht=s(()=>t("i",{class:"bi bi-x-lg"},null,-1)),Lt=[Ht],Nt={class:"mb-3"},Bt=s(()=>t("label",{class:"form-label is-required",for:"image"},"文章圖片",-1)),Ft=["src","alt"],jt=s(()=>t("hr",null,null,-1)),Ot=s(()=>t("hr",null,null,-1)),Rt=s(()=>t("p",{class:"is-required"},"文章內容",-1)),zt={class:"modal-footer justify-content-between align-items-center"},$t={class:"form-check"},Jt=s(()=>t("label",{class:"form-label",for:"isPublic"}," 是否公開",-1)),Wt=["disabled"];function Gt(i,o,U,I,e,m){const v=p("loading-overlay"),n=p("v-field"),a=p("upload-form"),b=p("ckeditor"),q=p("v-form");return c(),d("div",tt,[t("div",et,[r(v,{"is-loading":e.uploadState,"is-full":!1},null,8,["is-loading"]),t("div",ot,[t("div",it,[t("button",{type:"button",class:"btn border-0 p-0 fs-4",onClick:o[0]||(o[0]=(...y)=>i.hideModal&&i.hideModal(...y))},st)]),r(q,{onSubmit:m.confirmUpdate,ref:"form"},{default:C(({meta:y})=>[t("div",at,[t("ul",rt,[t("li",nt,[t("button",{type:"button",onClick:o[1]||(o[1]=l=>e.tab="setting"),class:k(["w-100 nav-link",{active:e.tab==="setting"}])}," 文章設定",2)]),t("li",ct,[t("button",{type:"button",onClick:o[2]||(o[2]=l=>e.tab="category"),class:k(["w-100 nav-link",{active:e.tab==="category"}])}," 文章分類",2)]),t("li",dt,[t("button",{type:"button",onClick:o[3]||(o[3]=l=>e.tab="image"),class:k(["w-100 nav-link",{active:e.tab==="image"}])}," 文章圖片",2)])]),h(t("div",null,[t("div",mt,[pt,r(n,{id:"title",type:"text",class:"form-control",modelValue:e.article.title,"onUpdate:modelValue":o[4]||(o[4]=l=>e.article.title=l),modelModifiers:{trim:!0},name:"title",rules:"required"},null,8,["modelValue"])]),t("div",ut,[ht,r(n,{id:"title",rows:"3",class:"form-control",modelValue:e.article.description,"onUpdate:modelValue":o[5]||(o[5]=l=>e.article.description=l),modelModifiers:{trim:!0},name:"description",as:"textarea"},null,8,["modelValue"])]),t("div",_t,[t("div",bt,[t("div",ft,[gt,r(n,{id:"author",type:"text",class:"form-control",modelValue:e.article.author,"onUpdate:modelValue":o[6]||(o[6]=l=>e.article.author=l),modelModifiers:{trim:!0},name:"author",rules:"required"},null,8,["modelValue"])]),t("div",vt,[t("div",yt,[wt,r(n,{id:"create_at",type:"date",class:"form-control",modelValue:m.createAt,"onUpdate:modelValue":o[7]||(o[7]=l=>m.createAt=l),name:"create_at",rules:"required"},null,8,["modelValue"])])])])])],512),[[A,e.tab==="setting"]]),h(t("div",null,[t("div",At,[t("div",kt,[t("div",Vt,[St,r(n,{id:"type",class:"form-select",modelValue:e.article.type,"onUpdate:modelValue":o[8]||(o[8]=l=>e.article.type=l),name:"type",rules:"required",as:"select"},{default:C(()=>[Ct,Pt,Mt]),_:1},8,["modelValue"])]),t("div",xt,[Ut,r(n,{id:"category",class:"form-control",modelValue:e.article.category,"onUpdate:modelValue":o[9]||(o[9]=l=>e.article.category=l),modelModifiers:{trim:!0},name:"category",rules:"required"},null,8,["modelValue"])])])]),t("div",It,[qt,t("div",Et,[(c(!0),d(V,null,x(e.article.tag,(l,w)=>(c(),d("div",{class:"col-md-3 position-relative",key:l},[h(t("input",{type:"text",class:"form-control","onUpdate:modelValue":S=>e.article.tag[w]=S},null,8,Dt),[[J,e.article.tag[w]]]),t("button",{type:"button",class:"btn btn-origin btn-inline",onClick:S=>e.article.tag.splice(w,1)},Lt,8,Tt)]))),128))]),t("button",{type:"button",class:"btn btn-primary",onClick:o[10]||(o[10]=l=>e.article.tag.push(""))}," 新增標籤")])],512),[[A,e.tab==="category"]]),h(t("div",null,[t("div",Nt,[Bt,r(n,{id:"image",type:"text",class:"form-control",modelValue:e.article.image,"onUpdate:modelValue":o[11]||(o[11]=l=>e.article.image=l),modelModifiers:{trim:!0},name:"image",rules:"required|url"},null,8,["modelValue"]),e.article.image?(c(),d("img",{key:0,class:"mt-3",src:e.article.image,alt:e.article.title},null,8,Ft)):G("",!0)]),jt,r(a,{"use-clipboard":!1,"upload-state":e.uploadState,disabled:e.article.image,onAddNewImage:m.addNewImage,onUpdateUploadState:m.updateUploadState},null,8,["upload-state","disabled","onAddNewImage","onUpdateUploadState"])],512),[[A,e.tab==="image"]]),Ot,Rt,r(b,{editor:i.editor,config:i.editorConfig,modelValue:e.article.content,"onUpdate:modelValue":o[12]||(o[12]=l=>e.article.content=l)},null,8,["editor","config","modelValue"])]),t("div",zt,[t("div",$t,[h(t("input",{id:"isPublic",type:"checkbox",class:"form-check-input","onUpdate:modelValue":o[13]||(o[13]=l=>e.article.isPublic=l)},null,512),[[W,e.article.isPublic]]),Jt]),t("div",null,[t("button",{type:"submit",class:"btn btn-primary me-2",disabled:!y.valid},"確認更新",8,Wt),t("button",{type:"button",class:"btn btn-outline-secondary",onClick:o[14]||(o[14]=(...l)=>i.hideModal&&i.hideModal(...l))},"取消")])])]),_:1},8,["onSubmit"])])])],512)}const Kt=M(Z,[["render",Gt],["__scopeId","data-v-86d5cafd"]]);var Qt={VITE_APP_SITE:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"ataraxia",BASE_URL:"/2024-Art-Webshop-Project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_SITE:Xt,VITE_APP_PATH:Yt}=Qt,Zt={components:{AdminArticleModal:Kt,PaginationComponent:L},data(){return{tempArticle:{}}},computed:{...P(g,["articles","article","pagination"])},methods:{...f(g,["getArticles","getArticle","deleteArticle","switchArticleStatus"]),...f(E,["createLoader","removeLoader"]),...f(D,["errorAlert"]),openModal(i){i?this.getArticle(i):this.tempArticle={isPublic:!1,create_at:this.$calc.now()},this.$refs.articleModal.showModal()},getArticle(i){this.createLoader("get-single-article"),this.$http.get(`${Xt}/api/${Yt}/admin/article/${i}`).then(o=>{this.tempArticle=o.data.article}).catch(o=>this.errorAlert(o)).finally(()=>this.removeLoader("get-single-article"))}},mounted(){this.getArticles()}},te={class:"text-end mb-7"},ee=t("h3",{class:"fs-2 mb-2"},"文章",-1),oe={class:"text-muted"},ie={class:"alert bg-gray flex-classic mb-5"},le={key:0,class:"table-responsive"},se={class:"table table-hover text-nowrap"},ae=t("thead",null,[t("tr",null,[t("th",{scope:"col",width:"10%"},"日期"),t("th",{scope:"col",width:"10%"},"分類"),t("th",{scope:"col",width:"50%"},"文章"),t("th",{scope:"col",width:"15%",class:"text-center"},"狀態"),t("th",{scope:"col",width:"15%",class:"text-center"},"處理")])],-1),re={class:"align-middle"},ne={class:"badge bg-highlight text-dark py-2"},ce={class:"fw-bold mb-2"},de={class:"text-muted fs-7"},me={class:"text-center"},pe={class:"form-switch"},ue=["checked","onChange"],he={class:"text-center"},_e={class:"d-flex flex-column gap-2"},be=["onClick"],fe=["onClick"],ge={key:1,class:"alert bg-gray"};function ve(i,o,U,I,e,m){const v=p("pagination-component"),n=p("admin-article-modal");return c(),d(V,null,[t("div",te,[ee,t("p",oe,"目前共有 "+_(i.articles.length)+" 篇文章 (꜆꜄꜆ ˙꒳˙)꜆꜄꜆ｵﾗｵﾗｵﾗｵﾗ",1)]),t("div",ie,[t("div",null,[t("button",{type:"button",class:"btn btn-highlight",onClick:o[0]||(o[0]=a=>m.openModal())},"新增文章")]),r(v,{current:i.pagination.current_page,total:i.pagination.total_pages,onSwitchPage:i.getArticles},null,8,["current","total","onSwitchPage"])]),i.articles.length?(c(),d("div",le,[t("table",se,[ae,t("tbody",re,[(c(!0),d(V,null,x(i.articles,a=>(c(),d("tr",{key:a.id},[t("td",null,_(i.$calc.formatDate(a.create_at*1e3,"/")),1),t("td",null,[t("span",ne,_(a.type),1)]),t("td",null,[t("p",ce,_(a.title),1),t("span",de,"作者｜"+_(a.author),1)]),t("td",me,[t("div",pe,[t("input",{type:"checkbox",role:"switch",class:"form-check-input",checked:a.isPublic,onChange:b=>i.switchArticleStatus(a)},null,40,ue)])]),t("td",he,[t("div",_e,[t("button",{type:"button",class:"w-100 btn btn-outline-secondary",onClick:b=>m.openModal(a.id)}," 編輯",8,be),t("button",{type:"button",class:"w-100 btn btn-outline-danger",onClick:b=>i.deleteArticle(a.id,a.title)}," 刪除",8,fe)])])]))),128))])])])):(c(),d("div",ge,"還沒有任何文章！趕快新增一篇吧！")),r(n,{ref:"articleModal","temp-article":e.tempArticle},null,8,["temp-article"])],64)}const fo=M(Zt,[["render",ve]]);export{fo as default};
