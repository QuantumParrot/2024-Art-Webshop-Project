import{a as d}from"./axios@1.6.7-Di5RpEPX.js";import{d as n}from"./pinia@2.1.7_vue@3.4.19-CHKlOEZr.js";import{l as h,a as m}from"./alert-dm0RMdUk.js";var p={VITE_APP_SITE:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"ataraxia",BASE_URL:"/2024-Art-Webshop-Project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_SITE:l,VITE_APP_PATH:c}=p,s=h(),o=m(),P=n("adminOrder",{state:()=>({orders:[],statesCode:{0:{title:"未確認款項",color:"#c62828"},1:{title:"已確認款項",color:"#ff6f00"},2:{title:"安排出貨中",color:"#1565c0"},3:{title:"商品配送中",color:"#00838f"},4:{title:"訂單已完成",color:"#388e3c"}},currentPage:1,orderState:"",isPaid:"",timeAscending:0}),getters:{totalPages:({orders:e})=>Math.ceil(e.length/5),ordersList:({orders:e})=>e.map(t=>{if(t.message.startsWith('{"')){const r=JSON.parse(t.message);return{...t,message:r.message||"無",project:r.project,state:parseInt(r.state,10),total:parseInt(t.total.toFixed(0),10)}}return{...t,project:t.project||"不指定",state:t.state||0,total:parseInt(t.total.toFixed(0),10)}}),displaying:({timeAscending:e,ordersList:t,currentPage:r})=>(t.sort((i,a)=>e?i.create_at-a.create_at:a.create_at-i.create_at),t.filter((i,a)=>Math.floor(a/5)+1===r)),unhandled:({ordersList:e})=>e.filter(t=>t.is_paid&&t.state===0).length},actions:{switchPage(e){this.currentPage=e},getOrders(){s.createLoader("get-orders"),d.get(`${l}/api/${c}/admin/orders`).then(e=>{this.orders=e.data.orders,this.switchPage(1)}).catch(e=>o.errorAlert(e)).finally(()=>s.removeLoader("get-orders"))},updateOrder(e,t){const{code:r,order:i}=e;s.setLoader(i.id),d.put(`${l}/api/${c}/admin/order/${i.id}`,{data:{...i,state:Number(r)}}).then(a=>{o.toastAlert(a.data.message,"success"),t(),this.getOrders()}).catch(a=>o.errorAlert(a)).finally(()=>s.setLoader(""))},deleteOrder(e,t){s.createLoader("delete-order"),d.delete(`${l}/api/${c}/admin/order/${e}`).then(()=>{o.toastAlert("我們懷念它 (´;ω;`)","success"),t(),this.getOrders()}).catch(r=>o.errorAlert(r)).finally(()=>s.removeLoader("delete-order"))},downTheDrain(){o.multiverseAlert(()=>{s.createLoader("tan-tiau"),d.delete(`${l}/api/${c}/admin/orders/all`).then(()=>{o.toastAlert("沒了 ... 都沒了 (´;ω;`)","success"),this.getOrders()}).catch(e=>o.errorAlert(e)).finally(()=>s.removeLoader("tan-tiau"))})},switchFilter(e,t){this[e]=t}}});export{P as a};
