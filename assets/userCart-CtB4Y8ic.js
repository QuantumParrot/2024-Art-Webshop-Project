import{a as o}from"./axios@1.6.7-Di5RpEPX.js";import{d}from"./pinia@2.1.7_vue@3.4.19-BGrtT45R.js";import{l as i,a as n}from"./alert-9WsjHxyk.js";var p={VITE_APP_SITE:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"ataraxia",BASE_URL:"/2024-Art-Webshop-Project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const e=i(),r=n(),{VITE_APP_SITE:c,VITE_APP_PATH:l}=p,f=d("userCart",{state:()=>({carts:[],sum:{}}),actions:{getCarts(){e.createLoader("get-carts"),o.get(`${c}/api/${l}/cart`).then(t=>{this.carts=t.data.data.carts,this.sum={total:+t.data.data.total.toFixed(0),finalTotal:+t.data.data.final_total.toFixed(0)}}).catch(t=>r.errorAlert(t)).finally(()=>e.removeLoader("get-carts"))},addToCart(t,a=1){e.setLoader(t),o.post(`${c}/api/${l}/cart`,{data:{product_id:t,qty:a}}).then(s=>{r.toastAlert(s.data.message,"success"),this.getCarts()}).catch(s=>r.errorAlert(s)).finally(()=>e.setLoader(""))},updateCart(t,a){e.createLoader("update-cart"),o.put(`${c}/api/${l}/cart/${t.id}`,{data:{product_id:t.product_id,qty:a}}).then(s=>{r.toastAlert(s.data.message,"success"),this.getCarts()}).catch(s=>r.errorAlert(s)).finally(()=>e.removeLoader("update-cart"))},deleteSingleCart(t){e.createLoader("delete-single-cart"),o.delete(`${c}/api/${l}/cart/${t}`).then(a=>{r.toastAlert(a.data.message,"success"),this.getCarts()}).catch(a=>r.errorAlert(a)).finally(()=>e.removeLoader("delete-single-cart"))},clearCart(){const t={title:"確定清空購物車？"};r.checkAlert(t,()=>{e.createLoader("delete-all-carts"),o.delete(`${c}/api/${l}/carts`).then(a=>{r.toastAlert(a.data.message,"success"),this.getCarts()}).catch(a=>r.errorAlert(a)).finally(()=>e.removeLoader("delete-all-carts"))})},useCoupon(t){e.setLoader("use-coupon"),o.post(`${c}/api/${l}/coupon`,{data:{code:t}}).then(a=>{this.sum.finalTotal=a.data.final_total,r.toastAlert("已套用優惠券！","success"),this.getCarts()}).catch(a=>r.errorAlert(a)).finally(()=>e.setLoader(""))}}});export{f as c};
